/* Generated by Spago v0.93.43 */
(() => {
  // output/Data.Show/foreign.js
  var showIntImpl = function(n) {
    return n.toString();
  };
  var showStringImpl = function(s) {
    var l = s.length;
    return '"' + s.replace(
      /[\0-\x1F\x7F"\\]/g,
      // eslint-disable-line no-control-regex
      function(c, i) {
        switch (c) {
          case '"':
          case "\\":
            return "\\" + c;
          case "\x07":
            return "\\a";
          case "\b":
            return "\\b";
          case "\f":
            return "\\f";
          case "\n":
            return "\\n";
          case "\r":
            return "\\r";
          case "	":
            return "\\t";
          case "\v":
            return "\\v";
        }
        var k = i + 1;
        var empty4 = k < l && s[k] >= "0" && s[k] <= "9" ? "\\&" : "";
        return "\\" + c.charCodeAt(0).toString(10) + empty4;
      }
    ) + '"';
  };

  // output/Type.Proxy/index.js
  var $$Proxy = /* @__PURE__ */ function() {
    function $$Proxy2() {
    }
    ;
    $$Proxy2.value = new $$Proxy2();
    return $$Proxy2;
  }();

  // output/Data.Symbol/index.js
  var reflectSymbol = function(dict) {
    return dict.reflectSymbol;
  };

  // output/Record.Unsafe/foreign.js
  var unsafeGet = function(label) {
    return function(rec) {
      return rec[label];
    };
  };
  var unsafeDelete = function(label) {
    return function(rec) {
      var copy = {};
      for (var key2 in rec) {
        if (key2 !== label && {}.hasOwnProperty.call(rec, key2)) {
          copy[key2] = rec[key2];
        }
      }
      return copy;
    };
  };

  // output/Data.Show/index.js
  var showString = {
    show: showStringImpl
  };
  var showInt = {
    show: showIntImpl
  };
  var show = function(dict) {
    return dict.show;
  };

  // output/Control.Semigroupoid/index.js
  var semigroupoidFn = {
    compose: function(f) {
      return function(g) {
        return function(x) {
          return f(g(x));
        };
      };
    }
  };

  // output/Control.Category/index.js
  var identity = function(dict) {
    return dict.identity;
  };
  var categoryFn = {
    identity: function(x) {
      return x;
    },
    Semigroupoid0: function() {
      return semigroupoidFn;
    }
  };

  // output/Effect/foreign.js
  var pureE = function(a) {
    return function() {
      return a;
    };
  };
  var bindE = function(a) {
    return function(f) {
      return function() {
        return f(a())();
      };
    };
  };

  // output/Data.Boolean/index.js
  var otherwise = true;

  // output/Data.Function/index.js
  var flip = function(f) {
    return function(b) {
      return function(a) {
        return f(a)(b);
      };
    };
  };
  var $$const = function(a) {
    return function(v) {
      return a;
    };
  };

  // output/Data.Functor/foreign.js
  var arrayMap = function(f) {
    return function(arr) {
      var l = arr.length;
      var result = new Array(l);
      for (var i = 0; i < l; i++) {
        result[i] = f(arr[i]);
      }
      return result;
    };
  };

  // output/Data.Unit/foreign.js
  var unit = void 0;

  // output/Data.Functor/index.js
  var map = function(dict) {
    return dict.map;
  };
  var $$void = function(dictFunctor) {
    return map(dictFunctor)($$const(unit));
  };
  var functorArray = {
    map: arrayMap
  };

  // output/Control.Apply/index.js
  var identity2 = /* @__PURE__ */ identity(categoryFn);
  var apply = function(dict) {
    return dict.apply;
  };
  var applySecond = function(dictApply) {
    var apply1 = apply(dictApply);
    var map8 = map(dictApply.Functor0());
    return function(a) {
      return function(b) {
        return apply1(map8($$const(identity2))(a))(b);
      };
    };
  };

  // output/Control.Applicative/index.js
  var pure = function(dict) {
    return dict.pure;
  };
  var when = function(dictApplicative) {
    var pure12 = pure(dictApplicative);
    return function(v) {
      return function(v1) {
        if (v) {
          return v1;
        }
        ;
        if (!v) {
          return pure12(unit);
        }
        ;
        throw new Error("Failed pattern match at Control.Applicative (line 63, column 1 - line 63, column 63): " + [v.constructor.name, v1.constructor.name]);
      };
    };
  };
  var liftA1 = function(dictApplicative) {
    var apply2 = apply(dictApplicative.Apply0());
    var pure12 = pure(dictApplicative);
    return function(f) {
      return function(a) {
        return apply2(pure12(f))(a);
      };
    };
  };

  // output/Control.Bind/foreign.js
  var arrayBind = typeof Array.prototype.flatMap === "function" ? function(arr) {
    return function(f) {
      return arr.flatMap(f);
    };
  } : function(arr) {
    return function(f) {
      var result = [];
      var l = arr.length;
      for (var i = 0; i < l; i++) {
        var xs = f(arr[i]);
        var k = xs.length;
        for (var j = 0; j < k; j++) {
          result.push(xs[j]);
        }
      }
      return result;
    };
  };

  // output/Control.Bind/index.js
  var discard = function(dict) {
    return dict.discard;
  };
  var bind = function(dict) {
    return dict.bind;
  };
  var discardUnit = {
    discard: function(dictBind) {
      return bind(dictBind);
    }
  };

  // output/Control.Monad/index.js
  var ap = function(dictMonad) {
    var bind5 = bind(dictMonad.Bind1());
    var pure7 = pure(dictMonad.Applicative0());
    return function(f) {
      return function(a) {
        return bind5(f)(function(f$prime) {
          return bind5(a)(function(a$prime) {
            return pure7(f$prime(a$prime));
          });
        });
      };
    };
  };

  // output/Data.Ring/foreign.js
  var intSub = function(x) {
    return function(y) {
      return x - y | 0;
    };
  };

  // output/Data.Semiring/foreign.js
  var intAdd = function(x) {
    return function(y) {
      return x + y | 0;
    };
  };
  var intMul = function(x) {
    return function(y) {
      return x * y | 0;
    };
  };

  // output/Data.Semiring/index.js
  var semiringInt = {
    add: intAdd,
    zero: 0,
    mul: intMul,
    one: 1
  };
  var add = function(dict) {
    return dict.add;
  };

  // output/Data.Ring/index.js
  var sub = function(dict) {
    return dict.sub;
  };
  var ringInt = {
    sub: intSub,
    Semiring0: function() {
      return semiringInt;
    }
  };

  // output/Data.Eq/foreign.js
  var refEq = function(r1) {
    return function(r2) {
      return r1 === r2;
    };
  };
  var eqBooleanImpl = refEq;
  var eqIntImpl = refEq;

  // output/Data.Eq/index.js
  var eqRowNil = {
    eqRecord: function(v) {
      return function(v1) {
        return function(v2) {
          return true;
        };
      };
    }
  };
  var eqRecord = function(dict) {
    return dict.eqRecord;
  };
  var eqRec = function() {
    return function(dictEqRecord) {
      return {
        eq: eqRecord(dictEqRecord)($$Proxy.value)
      };
    };
  };
  var eqInt = {
    eq: eqIntImpl
  };
  var eqBoolean = {
    eq: eqBooleanImpl
  };
  var eq1 = function(dict) {
    return dict.eq1;
  };
  var eq = function(dict) {
    return dict.eq;
  };
  var eq2 = /* @__PURE__ */ eq(eqBoolean);
  var eqRowCons = function(dictEqRecord) {
    var eqRecord1 = eqRecord(dictEqRecord);
    return function() {
      return function(dictIsSymbol) {
        var reflectSymbol2 = reflectSymbol(dictIsSymbol);
        return function(dictEq) {
          var eq32 = eq(dictEq);
          return {
            eqRecord: function(v) {
              return function(ra) {
                return function(rb) {
                  var tail2 = eqRecord1($$Proxy.value)(ra)(rb);
                  var key2 = reflectSymbol2($$Proxy.value);
                  var get = unsafeGet(key2);
                  return eq32(get(ra))(get(rb)) && tail2;
                };
              };
            }
          };
        };
      };
    };
  };
  var notEq = function(dictEq) {
    var eq32 = eq(dictEq);
    return function(x) {
      return function(y) {
        return eq2(eq32(x)(y))(false);
      };
    };
  };

  // output/Data.Ordering/index.js
  var LT = /* @__PURE__ */ function() {
    function LT2() {
    }
    ;
    LT2.value = new LT2();
    return LT2;
  }();
  var GT = /* @__PURE__ */ function() {
    function GT2() {
    }
    ;
    GT2.value = new GT2();
    return GT2;
  }();
  var EQ = /* @__PURE__ */ function() {
    function EQ2() {
    }
    ;
    EQ2.value = new EQ2();
    return EQ2;
  }();

  // output/Data.Semigroup/foreign.js
  var concatString = function(s1) {
    return function(s2) {
      return s1 + s2;
    };
  };
  var concatArray = function(xs) {
    return function(ys) {
      if (xs.length === 0) return ys;
      if (ys.length === 0) return xs;
      return xs.concat(ys);
    };
  };

  // output/Data.Semigroup/index.js
  var semigroupString = {
    append: concatString
  };
  var semigroupArray = {
    append: concatArray
  };
  var append = function(dict) {
    return dict.append;
  };

  // output/Data.Monoid/index.js
  var monoidString = {
    mempty: "",
    Semigroup0: function() {
      return semigroupString;
    }
  };
  var monoidArray = {
    mempty: [],
    Semigroup0: function() {
      return semigroupArray;
    }
  };
  var mempty = function(dict) {
    return dict.mempty;
  };

  // output/Effect/index.js
  var $runtime_lazy = function(name2, moduleName, init2) {
    var state2 = 0;
    var val;
    return function(lineNumber) {
      if (state2 === 2) return val;
      if (state2 === 1) throw new ReferenceError(name2 + " was needed before it finished initializing (module " + moduleName + ", line " + lineNumber + ")", moduleName, lineNumber);
      state2 = 1;
      val = init2();
      state2 = 2;
      return val;
    };
  };
  var monadEffect = {
    Applicative0: function() {
      return applicativeEffect;
    },
    Bind1: function() {
      return bindEffect;
    }
  };
  var bindEffect = {
    bind: bindE,
    Apply0: function() {
      return $lazy_applyEffect(0);
    }
  };
  var applicativeEffect = {
    pure: pureE,
    Apply0: function() {
      return $lazy_applyEffect(0);
    }
  };
  var $lazy_functorEffect = /* @__PURE__ */ $runtime_lazy("functorEffect", "Effect", function() {
    return {
      map: liftA1(applicativeEffect)
    };
  });
  var $lazy_applyEffect = /* @__PURE__ */ $runtime_lazy("applyEffect", "Effect", function() {
    return {
      apply: ap(monadEffect),
      Functor0: function() {
        return $lazy_functorEffect(0);
      }
    };
  });
  var functorEffect = /* @__PURE__ */ $lazy_functorEffect(20);

  // output/Effect.Class/index.js
  var monadEffectEffect = {
    liftEffect: /* @__PURE__ */ identity(categoryFn),
    Monad0: function() {
      return monadEffect;
    }
  };
  var liftEffect = function(dict) {
    return dict.liftEffect;
  };

  // output/Effect.Exception/foreign.js
  function error(msg) {
    return new Error(msg);
  }
  function throwException(e) {
    return function() {
      throw e;
    };
  }

  // output/Data.Bounded/foreign.js
  var topChar = String.fromCharCode(65535);
  var bottomChar = String.fromCharCode(0);
  var topNumber = Number.POSITIVE_INFINITY;
  var bottomNumber = Number.NEGATIVE_INFINITY;

  // output/Data.Ord/foreign.js
  var unsafeCompareImpl = function(lt) {
    return function(eq6) {
      return function(gt) {
        return function(x) {
          return function(y) {
            return x < y ? lt : x === y ? eq6 : gt;
          };
        };
      };
    };
  };
  var ordIntImpl = unsafeCompareImpl;

  // output/Data.Ord/index.js
  var ordInt = /* @__PURE__ */ function() {
    return {
      compare: ordIntImpl(LT.value)(EQ.value)(GT.value),
      Eq0: function() {
        return eqInt;
      }
    };
  }();
  var compare = function(dict) {
    return dict.compare;
  };
  var lessThan = function(dictOrd) {
    var compare3 = compare(dictOrd);
    return function(a1) {
      return function(a2) {
        var v = compare3(a1)(a2);
        if (v instanceof LT) {
          return true;
        }
        ;
        return false;
      };
    };
  };
  var lessThanOrEq = function(dictOrd) {
    var compare3 = compare(dictOrd);
    return function(a1) {
      return function(a2) {
        var v = compare3(a1)(a2);
        if (v instanceof GT) {
          return false;
        }
        ;
        return true;
      };
    };
  };

  // output/Data.Generic.Rep/index.js
  var from = function(dict) {
    return dict.from;
  };

  // output/Data.Maybe/index.js
  var identity3 = /* @__PURE__ */ identity(categoryFn);
  var Nothing = /* @__PURE__ */ function() {
    function Nothing2() {
    }
    ;
    Nothing2.value = new Nothing2();
    return Nothing2;
  }();
  var Just = /* @__PURE__ */ function() {
    function Just2(value0) {
      this.value0 = value0;
    }
    ;
    Just2.create = function(value0) {
      return new Just2(value0);
    };
    return Just2;
  }();
  var maybe$prime = function(v) {
    return function(v1) {
      return function(v2) {
        if (v2 instanceof Nothing) {
          return v(unit);
        }
        ;
        if (v2 instanceof Just) {
          return v1(v2.value0);
        }
        ;
        throw new Error("Failed pattern match at Data.Maybe (line 250, column 1 - line 250, column 62): " + [v.constructor.name, v1.constructor.name, v2.constructor.name]);
      };
    };
  };
  var maybe = function(v) {
    return function(v1) {
      return function(v2) {
        if (v2 instanceof Nothing) {
          return v;
        }
        ;
        if (v2 instanceof Just) {
          return v1(v2.value0);
        }
        ;
        throw new Error("Failed pattern match at Data.Maybe (line 237, column 1 - line 237, column 51): " + [v.constructor.name, v1.constructor.name, v2.constructor.name]);
      };
    };
  };
  var functorMaybe = {
    map: function(v) {
      return function(v1) {
        if (v1 instanceof Just) {
          return new Just(v(v1.value0));
        }
        ;
        return Nothing.value;
      };
    }
  };
  var map2 = /* @__PURE__ */ map(functorMaybe);
  var fromMaybe$prime = function(a) {
    return maybe$prime(a)(identity3);
  };
  var applyMaybe = {
    apply: function(v) {
      return function(v1) {
        if (v instanceof Just) {
          return map2(v.value0)(v1);
        }
        ;
        if (v instanceof Nothing) {
          return Nothing.value;
        }
        ;
        throw new Error("Failed pattern match at Data.Maybe (line 67, column 1 - line 69, column 30): " + [v.constructor.name, v1.constructor.name]);
      };
    },
    Functor0: function() {
      return functorMaybe;
    }
  };
  var bindMaybe = {
    bind: function(v) {
      return function(v1) {
        if (v instanceof Just) {
          return v1(v.value0);
        }
        ;
        if (v instanceof Nothing) {
          return Nothing.value;
        }
        ;
        throw new Error("Failed pattern match at Data.Maybe (line 125, column 1 - line 127, column 28): " + [v.constructor.name, v1.constructor.name]);
      };
    },
    Apply0: function() {
      return applyMaybe;
    }
  };
  var applicativeMaybe = /* @__PURE__ */ function() {
    return {
      pure: Just.create,
      Apply0: function() {
        return applyMaybe;
      }
    };
  }();
  var altMaybe = {
    alt: function(v) {
      return function(v1) {
        if (v instanceof Nothing) {
          return v1;
        }
        ;
        return v;
      };
    },
    Functor0: function() {
      return functorMaybe;
    }
  };
  var plusMaybe = /* @__PURE__ */ function() {
    return {
      empty: Nothing.value,
      Alt0: function() {
        return altMaybe;
      }
    };
  }();
  var alternativeMaybe = {
    Applicative0: function() {
      return applicativeMaybe;
    },
    Plus1: function() {
      return plusMaybe;
    }
  };

  // output/Data.Either/index.js
  var Left = /* @__PURE__ */ function() {
    function Left2(value0) {
      this.value0 = value0;
    }
    ;
    Left2.create = function(value0) {
      return new Left2(value0);
    };
    return Left2;
  }();
  var Right = /* @__PURE__ */ function() {
    function Right2(value0) {
      this.value0 = value0;
    }
    ;
    Right2.create = function(value0) {
      return new Right2(value0);
    };
    return Right2;
  }();
  var fromRight$prime = function(v) {
    return function(v1) {
      if (v1 instanceof Right) {
        return v1.value0;
      }
      ;
      return v(unit);
    };
  };

  // output/Effect.Exception/index.js
  var $$throw = function($4) {
    return throwException(error($4));
  };

  // output/Control.Monad.Reader.Class/index.js
  var ask = function(dict) {
    return dict.ask;
  };

  // output/Effect.Ref/foreign.js
  var _new = function(val) {
    return function() {
      return { value: val };
    };
  };
  var read = function(ref) {
    return function() {
      return ref.value;
    };
  };
  var modifyImpl = function(f) {
    return function(ref) {
      return function() {
        var t = f(ref.value);
        ref.value = t.state;
        return t.value;
      };
    };
  };
  var write = function(val) {
    return function(ref) {
      return function() {
        ref.value = val;
      };
    };
  };

  // output/Effect.Ref/index.js
  var $$new = _new;
  var modify$prime = modifyImpl;
  var modify = function(f) {
    return modify$prime(function(s) {
      var s$prime = f(s);
      return {
        state: s$prime,
        value: s$prime
      };
    });
  };

  // output/Unsafe.Coerce/foreign.js
  var unsafeCoerce2 = function(x) {
    return x;
  };

  // output/Data.HeytingAlgebra/foreign.js
  var boolConj = function(b1) {
    return function(b2) {
      return b1 && b2;
    };
  };
  var boolDisj = function(b1) {
    return function(b2) {
      return b1 || b2;
    };
  };
  var boolNot = function(b) {
    return !b;
  };

  // output/Data.HeytingAlgebra/index.js
  var tt = function(dict) {
    return dict.tt;
  };
  var not = function(dict) {
    return dict.not;
  };
  var disj = function(dict) {
    return dict.disj;
  };
  var heytingAlgebraBoolean = {
    ff: false,
    tt: true,
    implies: function(a) {
      return function(b) {
        return disj(heytingAlgebraBoolean)(not(heytingAlgebraBoolean)(a))(b);
      };
    },
    conj: boolConj,
    disj: boolDisj,
    not: boolNot
  };
  var conj = function(dict) {
    return dict.conj;
  };

  // output/Data.Tuple/index.js
  var Tuple = /* @__PURE__ */ function() {
    function Tuple2(value0, value1) {
      this.value0 = value0;
      this.value1 = value1;
    }
    ;
    Tuple2.create = function(value0) {
      return function(value1) {
        return new Tuple2(value0, value1);
      };
    };
    return Tuple2;
  }();
  var fst = function(v) {
    return v.value0;
  };

  // output/Control.Monad.Trans.Class/index.js
  var lift = function(dict) {
    return dict.lift;
  };

  // output/Control.Plus/index.js
  var empty = function(dict) {
    return dict.empty;
  };

  // output/Safe.Coerce/index.js
  var coerce = function() {
    return unsafeCoerce2;
  };

  // output/Data.Newtype/index.js
  var coerce2 = /* @__PURE__ */ coerce();
  var wrap = function() {
    return coerce2;
  };
  var wrap1 = /* @__PURE__ */ wrap();
  var unwrap = function() {
    return coerce2;
  };
  var unwrap1 = /* @__PURE__ */ unwrap();
  var over = function() {
    return function() {
      return function(v) {
        return coerce2;
      };
    };
  };
  var modify2 = function() {
    return function(fn) {
      return function(t) {
        return wrap1(fn(unwrap1(t)));
      };
    };
  };
  var alaF = function() {
    return function() {
      return function() {
        return function() {
          return function(v) {
            return coerce2;
          };
        };
      };
    };
  };

  // output/Control.Monad.Reader.Trans/index.js
  var ReaderT = function(x) {
    return x;
  };
  var runReaderT = function(v) {
    return v;
  };
  var monadTransReaderT = {
    lift: function(dictMonad) {
      return function($153) {
        return ReaderT($$const($153));
      };
    }
  };
  var lift3 = /* @__PURE__ */ lift(monadTransReaderT);
  var mapReaderT = function(f) {
    return function(v) {
      return function($154) {
        return f(v($154));
      };
    };
  };
  var functorReaderT = function(dictFunctor) {
    return {
      map: function() {
        var $155 = map(dictFunctor);
        return function($156) {
          return mapReaderT($155($156));
        };
      }()
    };
  };
  var applyReaderT = function(dictApply) {
    var apply2 = apply(dictApply);
    var functorReaderT1 = functorReaderT(dictApply.Functor0());
    return {
      apply: function(v) {
        return function(v1) {
          return function(r) {
            return apply2(v(r))(v1(r));
          };
        };
      },
      Functor0: function() {
        return functorReaderT1;
      }
    };
  };
  var bindReaderT = function(dictBind) {
    var bind5 = bind(dictBind);
    var applyReaderT1 = applyReaderT(dictBind.Apply0());
    return {
      bind: function(v) {
        return function(k) {
          return function(r) {
            return bind5(v(r))(function(a) {
              var v1 = k(a);
              return v1(r);
            });
          };
        };
      },
      Apply0: function() {
        return applyReaderT1;
      }
    };
  };
  var applicativeReaderT = function(dictApplicative) {
    var applyReaderT1 = applyReaderT(dictApplicative.Apply0());
    return {
      pure: function() {
        var $160 = pure(dictApplicative);
        return function($161) {
          return ReaderT($$const($160($161)));
        };
      }(),
      Apply0: function() {
        return applyReaderT1;
      }
    };
  };
  var monadReaderT = function(dictMonad) {
    var applicativeReaderT1 = applicativeReaderT(dictMonad.Applicative0());
    var bindReaderT1 = bindReaderT(dictMonad.Bind1());
    return {
      Applicative0: function() {
        return applicativeReaderT1;
      },
      Bind1: function() {
        return bindReaderT1;
      }
    };
  };
  var monadAskReaderT = function(dictMonad) {
    var monadReaderT1 = monadReaderT(dictMonad);
    return {
      ask: pure(dictMonad.Applicative0()),
      Monad0: function() {
        return monadReaderT1;
      }
    };
  };
  var monadEffectReader = function(dictMonadEffect) {
    var Monad0 = dictMonadEffect.Monad0();
    var monadReaderT1 = monadReaderT(Monad0);
    return {
      liftEffect: function() {
        var $163 = lift3(Monad0);
        var $164 = liftEffect(dictMonadEffect);
        return function($165) {
          return $163($164($165));
        };
      }(),
      Monad0: function() {
        return monadReaderT1;
      }
    };
  };

  // output/Data.Array/foreign.js
  var rangeImpl = function(start, end) {
    var step = start > end ? -1 : 1;
    var result = new Array(step * (end - start) + 1);
    var i = start, n = 0;
    while (i !== end) {
      result[n++] = i;
      i += step;
    }
    result[n] = i;
    return result;
  };
  var replicateFill = function(count, value) {
    if (count < 1) {
      return [];
    }
    var result = new Array(count);
    return result.fill(value);
  };
  var replicatePolyfill = function(count, value) {
    var result = [];
    var n = 0;
    for (var i = 0; i < count; i++) {
      result[n++] = value;
    }
    return result;
  };
  var replicateImpl = typeof Array.prototype.fill === "function" ? replicateFill : replicatePolyfill;
  var length = function(xs) {
    return xs.length;
  };
  var unconsImpl = function(empty4, next, xs) {
    return xs.length === 0 ? empty4({}) : next(xs[0])(xs.slice(1));
  };
  var indexImpl = function(just, nothing, xs, i) {
    return i < 0 || i >= xs.length ? nothing : just(xs[i]);
  };
  var sliceImpl = function(s, e, l) {
    return l.slice(s, e);
  };

  // output/Data.Array.ST/foreign.js
  function unsafeFreezeThawImpl(xs) {
    return xs;
  }
  var unsafeFreezeImpl = unsafeFreezeThawImpl;
  function copyImpl(xs) {
    return xs.slice();
  }
  var thawImpl = copyImpl;
  var pushImpl = function(a, xs) {
    return xs.push(a);
  };

  // output/Control.Monad.ST.Uncurried/foreign.js
  var runSTFn1 = function runSTFn12(fn) {
    return function(a) {
      return function() {
        return fn(a);
      };
    };
  };
  var runSTFn2 = function runSTFn22(fn) {
    return function(a) {
      return function(b) {
        return function() {
          return fn(a, b);
        };
      };
    };
  };

  // output/Data.Array.ST/index.js
  var unsafeFreeze = /* @__PURE__ */ runSTFn1(unsafeFreezeImpl);
  var thaw = /* @__PURE__ */ runSTFn1(thawImpl);
  var withArray = function(f) {
    return function(xs) {
      return function __do2() {
        var result = thaw(xs)();
        f(result)();
        return unsafeFreeze(result)();
      };
    };
  };
  var push = /* @__PURE__ */ runSTFn2(pushImpl);

  // output/Data.Foldable/foreign.js
  var foldrArray = function(f) {
    return function(init2) {
      return function(xs) {
        var acc = init2;
        var len = xs.length;
        for (var i = len - 1; i >= 0; i--) {
          acc = f(xs[i])(acc);
        }
        return acc;
      };
    };
  };
  var foldlArray = function(f) {
    return function(init2) {
      return function(xs) {
        var acc = init2;
        var len = xs.length;
        for (var i = 0; i < len; i++) {
          acc = f(acc)(xs[i]);
        }
        return acc;
      };
    };
  };

  // output/Data.Monoid.Conj/index.js
  var Conj = function(x) {
    return x;
  };
  var semigroupConj = function(dictHeytingAlgebra) {
    var conj2 = conj(dictHeytingAlgebra);
    return {
      append: function(v) {
        return function(v1) {
          return conj2(v)(v1);
        };
      }
    };
  };
  var monoidConj = function(dictHeytingAlgebra) {
    var semigroupConj1 = semigroupConj(dictHeytingAlgebra);
    return {
      mempty: tt(dictHeytingAlgebra),
      Semigroup0: function() {
        return semigroupConj1;
      }
    };
  };

  // output/Data.Foldable/index.js
  var identity4 = /* @__PURE__ */ identity(categoryFn);
  var alaF2 = /* @__PURE__ */ alaF()()()();
  var foldr = function(dict) {
    return dict.foldr;
  };
  var traverse_ = function(dictApplicative) {
    var applySecond2 = applySecond(dictApplicative.Apply0());
    var pure7 = pure(dictApplicative);
    return function(dictFoldable) {
      var foldr22 = foldr(dictFoldable);
      return function(f) {
        return foldr22(function($454) {
          return applySecond2(f($454));
        })(pure7(unit));
      };
    };
  };
  var foldl = function(dict) {
    return dict.foldl;
  };
  var intercalate = function(dictFoldable) {
    var foldl2 = foldl(dictFoldable);
    return function(dictMonoid) {
      var append5 = append(dictMonoid.Semigroup0());
      var mempty2 = mempty(dictMonoid);
      return function(sep) {
        return function(xs) {
          var go = function(v) {
            return function(v1) {
              if (v.init) {
                return {
                  init: false,
                  acc: v1
                };
              }
              ;
              return {
                init: false,
                acc: append5(v.acc)(append5(sep)(v1))
              };
            };
          };
          return foldl2(go)({
            init: true,
            acc: mempty2
          })(xs).acc;
        };
      };
    };
  };
  var foldMapDefaultR = function(dictFoldable) {
    var foldr22 = foldr(dictFoldable);
    return function(dictMonoid) {
      var append5 = append(dictMonoid.Semigroup0());
      var mempty2 = mempty(dictMonoid);
      return function(f) {
        return foldr22(function(x) {
          return function(acc) {
            return append5(f(x))(acc);
          };
        })(mempty2);
      };
    };
  };
  var foldableArray = {
    foldr: foldrArray,
    foldl: foldlArray,
    foldMap: function(dictMonoid) {
      return foldMapDefaultR(foldableArray)(dictMonoid);
    }
  };
  var foldMap = function(dict) {
    return dict.foldMap;
  };
  var fold = function(dictFoldable) {
    var foldMap2 = foldMap(dictFoldable);
    return function(dictMonoid) {
      return foldMap2(dictMonoid)(identity4);
    };
  };
  var all = function(dictFoldable) {
    var foldMap2 = foldMap(dictFoldable);
    return function(dictHeytingAlgebra) {
      return alaF2(Conj)(foldMap2(monoidConj(dictHeytingAlgebra)));
    };
  };
  var and = function(dictFoldable) {
    var all1 = all(dictFoldable);
    return function(dictHeytingAlgebra) {
      return all1(dictHeytingAlgebra)(identity4);
    };
  };

  // output/Data.Function.Uncurried/foreign.js
  var runFn2 = function(fn) {
    return function(a) {
      return function(b) {
        return fn(a, b);
      };
    };
  };
  var runFn3 = function(fn) {
    return function(a) {
      return function(b) {
        return function(c) {
          return fn(a, b, c);
        };
      };
    };
  };
  var runFn4 = function(fn) {
    return function(a) {
      return function(b) {
        return function(c) {
          return function(d) {
            return fn(a, b, c, d);
          };
        };
      };
    };
  };

  // output/Data.FunctorWithIndex/foreign.js
  var mapWithIndexArray = function(f) {
    return function(xs) {
      var l = xs.length;
      var result = Array(l);
      for (var i = 0; i < l; i++) {
        result[i] = f(i)(xs[i]);
      }
      return result;
    };
  };

  // output/Data.FunctorWithIndex/index.js
  var mapWithIndex = function(dict) {
    return dict.mapWithIndex;
  };
  var functorWithIndexArray = {
    mapWithIndex: mapWithIndexArray,
    Functor0: function() {
      return functorArray;
    }
  };

  // output/Data.Traversable/foreign.js
  var traverseArrayImpl = /* @__PURE__ */ function() {
    function array1(a) {
      return [a];
    }
    function array2(a) {
      return function(b) {
        return [a, b];
      };
    }
    function array3(a) {
      return function(b) {
        return function(c) {
          return [a, b, c];
        };
      };
    }
    function concat2(xs) {
      return function(ys) {
        return xs.concat(ys);
      };
    }
    return function(apply2) {
      return function(map8) {
        return function(pure7) {
          return function(f) {
            return function(array) {
              function go(bot, top2) {
                switch (top2 - bot) {
                  case 0:
                    return pure7([]);
                  case 1:
                    return map8(array1)(f(array[bot]));
                  case 2:
                    return apply2(map8(array2)(f(array[bot])))(f(array[bot + 1]));
                  case 3:
                    return apply2(apply2(map8(array3)(f(array[bot])))(f(array[bot + 1])))(f(array[bot + 2]));
                  default:
                    var pivot = bot + Math.floor((top2 - bot) / 4) * 2;
                    return apply2(map8(concat2)(go(bot, pivot)))(go(pivot, top2));
                }
              }
              return go(0, array.length);
            };
          };
        };
      };
    };
  }();

  // output/Data.Traversable/index.js
  var identity5 = /* @__PURE__ */ identity(categoryFn);
  var traverse = function(dict) {
    return dict.traverse;
  };
  var sequenceDefault = function(dictTraversable) {
    var traverse22 = traverse(dictTraversable);
    return function(dictApplicative) {
      return traverse22(dictApplicative)(identity5);
    };
  };
  var traversableArray = {
    traverse: function(dictApplicative) {
      var Apply0 = dictApplicative.Apply0();
      return traverseArrayImpl(apply(Apply0))(map(Apply0.Functor0()))(pure(dictApplicative));
    },
    sequence: function(dictApplicative) {
      return sequenceDefault(traversableArray)(dictApplicative);
    },
    Functor0: function() {
      return functorArray;
    },
    Foldable1: function() {
      return foldableArray;
    }
  };
  var sequence = function(dict) {
    return dict.sequence;
  };

  // output/Data.Unfoldable1/index.js
  var unfoldable1Maybe = {
    unfoldr1: function(f) {
      return function(b) {
        return new Just(fst(f(b)));
      };
    }
  };

  // output/Data.Unfoldable/index.js
  var map3 = /* @__PURE__ */ map(functorMaybe);
  var unfoldr = function(dict) {
    return dict.unfoldr;
  };
  var unfoldableMaybe = {
    unfoldr: function(f) {
      return function(b) {
        return map3(fst)(f(b));
      };
    },
    Unfoldable10: function() {
      return unfoldable1Maybe;
    }
  };
  var none = function(dictUnfoldable) {
    return unfoldr(dictUnfoldable)($$const(Nothing.value))(unit);
  };

  // output/Data.Array/index.js
  var intercalate1 = /* @__PURE__ */ intercalate(foldableArray);
  var fold1 = /* @__PURE__ */ fold(foldableArray);
  var uncons = /* @__PURE__ */ function() {
    return runFn3(unconsImpl)($$const(Nothing.value))(function(x) {
      return function(xs) {
        return new Just({
          head: x,
          tail: xs
        });
      };
    });
  }();
  var snoc = function(xs) {
    return function(x) {
      return withArray(push(x))(xs)();
    };
  };
  var slice = /* @__PURE__ */ runFn3(sliceImpl);
  var splitAt = function(v) {
    return function(v1) {
      if (v <= 0) {
        return {
          before: [],
          after: v1
        };
      }
      ;
      return {
        before: slice(0)(v)(v1),
        after: slice(v)(length(v1))(v1)
      };
    };
  };
  var take = function(n) {
    return function(xs) {
      var $152 = n < 1;
      if ($152) {
        return [];
      }
      ;
      return slice(0)(n)(xs);
    };
  };
  var range2 = /* @__PURE__ */ runFn2(rangeImpl);
  var $$null = function(xs) {
    return length(xs) === 0;
  };
  var intercalate2 = function(dictMonoid) {
    return intercalate1(dictMonoid);
  };
  var index = /* @__PURE__ */ function() {
    return runFn4(indexImpl)(Just.create)(Nothing.value);
  }();
  var fold2 = function(dictMonoid) {
    return fold1(dictMonoid);
  };
  var drop = function(n) {
    return function(xs) {
      var $173 = n < 1;
      if ($173) {
        return xs;
      }
      ;
      return slice(n)(length(xs))(xs);
    };
  };

  // output/Control.Alternative/index.js
  var guard = function(dictAlternative) {
    var pure7 = pure(dictAlternative.Applicative0());
    var empty4 = empty(dictAlternative.Plus1());
    return function(v) {
      if (v) {
        return pure7(unit);
      }
      ;
      if (!v) {
        return empty4;
      }
      ;
      throw new Error("Failed pattern match at Control.Alternative (line 48, column 1 - line 48, column 54): " + [v.constructor.name]);
    };
  };

  // output/Data.Eq.Generic/index.js
  var genericEqArgument = function(dictEq) {
    var eq6 = eq(dictEq);
    return {
      "genericEq'": function(v) {
        return function(v1) {
          return eq6(v)(v1);
        };
      }
    };
  };
  var genericEq$prime = function(dict) {
    return dict["genericEq'"];
  };
  var genericEqConstructor = function(dictGenericEq) {
    var genericEq$prime1 = genericEq$prime(dictGenericEq);
    return {
      "genericEq'": function(v) {
        return function(v1) {
          return genericEq$prime1(v)(v1);
        };
      }
    };
  };
  var genericEq = function(dictGeneric) {
    var from3 = from(dictGeneric);
    return function(dictGenericEq) {
      var genericEq$prime1 = genericEq$prime(dictGenericEq);
      return function(x) {
        return function(y) {
          return genericEq$prime1(from3(x))(from3(y));
        };
      };
    };
  };

  // output/Data.FoldableWithIndex/index.js
  var foldr8 = /* @__PURE__ */ foldr(foldableArray);
  var mapWithIndex2 = /* @__PURE__ */ mapWithIndex(functorWithIndexArray);
  var foldl8 = /* @__PURE__ */ foldl(foldableArray);
  var foldrWithIndex = function(dict) {
    return dict.foldrWithIndex;
  };
  var traverseWithIndex_ = function(dictApplicative) {
    var applySecond2 = applySecond(dictApplicative.Apply0());
    var pure7 = pure(dictApplicative);
    return function(dictFoldableWithIndex) {
      var foldrWithIndex1 = foldrWithIndex(dictFoldableWithIndex);
      return function(f) {
        return foldrWithIndex1(function(i) {
          var $289 = f(i);
          return function($290) {
            return applySecond2($289($290));
          };
        })(pure7(unit));
      };
    };
  };
  var foldMapWithIndexDefaultR = function(dictFoldableWithIndex) {
    var foldrWithIndex1 = foldrWithIndex(dictFoldableWithIndex);
    return function(dictMonoid) {
      var append5 = append(dictMonoid.Semigroup0());
      var mempty2 = mempty(dictMonoid);
      return function(f) {
        return foldrWithIndex1(function(i) {
          return function(x) {
            return function(acc) {
              return append5(f(i)(x))(acc);
            };
          };
        })(mempty2);
      };
    };
  };
  var foldableWithIndexArray = {
    foldrWithIndex: function(f) {
      return function(z) {
        var $291 = foldr8(function(v) {
          return function(y) {
            return f(v.value0)(v.value1)(y);
          };
        })(z);
        var $292 = mapWithIndex2(Tuple.create);
        return function($293) {
          return $291($292($293));
        };
      };
    },
    foldlWithIndex: function(f) {
      return function(z) {
        var $294 = foldl8(function(y) {
          return function(v) {
            return f(v.value0)(y)(v.value1);
          };
        })(z);
        var $295 = mapWithIndex2(Tuple.create);
        return function($296) {
          return $294($295($296));
        };
      };
    },
    foldMapWithIndex: function(dictMonoid) {
      return foldMapWithIndexDefaultR(foldableWithIndexArray)(dictMonoid);
    },
    Foldable0: function() {
      return foldableArray;
    }
  };

  // output/Data.TraversableWithIndex/index.js
  var traverseWithIndexDefault = function(dictTraversableWithIndex) {
    var sequence3 = sequence(dictTraversableWithIndex.Traversable2());
    var mapWithIndex5 = mapWithIndex(dictTraversableWithIndex.FunctorWithIndex0());
    return function(dictApplicative) {
      var sequence13 = sequence3(dictApplicative);
      return function(f) {
        var $174 = mapWithIndex5(f);
        return function($175) {
          return sequence13($174($175));
        };
      };
    };
  };
  var traverseWithIndex = function(dict) {
    return dict.traverseWithIndex;
  };
  var traversableWithIndexArray = {
    traverseWithIndex: function(dictApplicative) {
      return traverseWithIndexDefault(traversableWithIndexArray)(dictApplicative);
    },
    FunctorWithIndex0: function() {
      return functorWithIndexArray;
    },
    FoldableWithIndex1: function() {
      return foldableWithIndexArray;
    },
    Traversable2: function() {
      return traversableArray;
    }
  };

  // output/Data.NonEmpty/index.js
  var NonEmpty = /* @__PURE__ */ function() {
    function NonEmpty2(value0, value1) {
      this.value0 = value0;
      this.value1 = value1;
    }
    ;
    NonEmpty2.create = function(value0) {
      return function(value1) {
        return new NonEmpty2(value0, value1);
      };
    };
    return NonEmpty2;
  }();
  var semigroupNonEmpty = function(dictApplicative) {
    var pure7 = pure(dictApplicative);
    return function(dictSemigroup) {
      var append13 = append(dictSemigroup);
      return {
        append: function(v) {
          return function(v1) {
            return new NonEmpty(v.value0, append13(v.value1)(append13(pure7(v1.value0))(v1.value1)));
          };
        }
      };
    };
  };
  var head = function(v) {
    return v.value0;
  };
  var foldableNonEmpty = function(dictFoldable) {
    var foldMap2 = foldMap(dictFoldable);
    var foldl2 = foldl(dictFoldable);
    var foldr4 = foldr(dictFoldable);
    return {
      foldMap: function(dictMonoid) {
        var append13 = append(dictMonoid.Semigroup0());
        var foldMap12 = foldMap2(dictMonoid);
        return function(f) {
          return function(v) {
            return append13(f(v.value0))(foldMap12(f)(v.value1));
          };
        };
      },
      foldl: function(f) {
        return function(b) {
          return function(v) {
            return foldl2(f)(f(b)(v.value0))(v.value1);
          };
        };
      },
      foldr: function(f) {
        return function(b) {
          return function(v) {
            return f(v.value0)(foldr4(f)(b)(v.value1));
          };
        };
      }
    };
  };

  // output/Data.List.Types/index.js
  var Nil = /* @__PURE__ */ function() {
    function Nil2() {
    }
    ;
    Nil2.value = new Nil2();
    return Nil2;
  }();
  var Cons = /* @__PURE__ */ function() {
    function Cons2(value0, value1) {
      this.value0 = value0;
      this.value1 = value1;
    }
    ;
    Cons2.create = function(value0) {
      return function(value1) {
        return new Cons2(value0, value1);
      };
    };
    return Cons2;
  }();
  var listMap = function(f) {
    var chunkedRevMap = function($copy_v) {
      return function($copy_v1) {
        var $tco_var_v = $copy_v;
        var $tco_done = false;
        var $tco_result;
        function $tco_loop(v, v1) {
          if (v1 instanceof Cons && (v1.value1 instanceof Cons && v1.value1.value1 instanceof Cons)) {
            $tco_var_v = new Cons(v1, v);
            $copy_v1 = v1.value1.value1.value1;
            return;
          }
          ;
          var unrolledMap = function(v2) {
            if (v2 instanceof Cons && (v2.value1 instanceof Cons && v2.value1.value1 instanceof Nil)) {
              return new Cons(f(v2.value0), new Cons(f(v2.value1.value0), Nil.value));
            }
            ;
            if (v2 instanceof Cons && v2.value1 instanceof Nil) {
              return new Cons(f(v2.value0), Nil.value);
            }
            ;
            return Nil.value;
          };
          var reverseUnrolledMap = function($copy_v2) {
            return function($copy_v3) {
              var $tco_var_v2 = $copy_v2;
              var $tco_done1 = false;
              var $tco_result2;
              function $tco_loop2(v2, v3) {
                if (v2 instanceof Cons && (v2.value0 instanceof Cons && (v2.value0.value1 instanceof Cons && v2.value0.value1.value1 instanceof Cons))) {
                  $tco_var_v2 = v2.value1;
                  $copy_v3 = new Cons(f(v2.value0.value0), new Cons(f(v2.value0.value1.value0), new Cons(f(v2.value0.value1.value1.value0), v3)));
                  return;
                }
                ;
                $tco_done1 = true;
                return v3;
              }
              ;
              while (!$tco_done1) {
                $tco_result2 = $tco_loop2($tco_var_v2, $copy_v3);
              }
              ;
              return $tco_result2;
            };
          };
          $tco_done = true;
          return reverseUnrolledMap(v)(unrolledMap(v1));
        }
        ;
        while (!$tco_done) {
          $tco_result = $tco_loop($tco_var_v, $copy_v1);
        }
        ;
        return $tco_result;
      };
    };
    return chunkedRevMap(Nil.value);
  };
  var functorList = {
    map: listMap
  };
  var map4 = /* @__PURE__ */ map(functorList);
  var foldableList = {
    foldr: function(f) {
      return function(b) {
        var rev = function() {
          var go = function($copy_v) {
            return function($copy_v1) {
              var $tco_var_v = $copy_v;
              var $tco_done = false;
              var $tco_result;
              function $tco_loop(v, v1) {
                if (v1 instanceof Nil) {
                  $tco_done = true;
                  return v;
                }
                ;
                if (v1 instanceof Cons) {
                  $tco_var_v = new Cons(v1.value0, v);
                  $copy_v1 = v1.value1;
                  return;
                }
                ;
                throw new Error("Failed pattern match at Data.List.Types (line 107, column 7 - line 107, column 23): " + [v.constructor.name, v1.constructor.name]);
              }
              ;
              while (!$tco_done) {
                $tco_result = $tco_loop($tco_var_v, $copy_v1);
              }
              ;
              return $tco_result;
            };
          };
          return go(Nil.value);
        }();
        var $284 = foldl(foldableList)(flip(f))(b);
        return function($285) {
          return $284(rev($285));
        };
      };
    },
    foldl: function(f) {
      var go = function($copy_b) {
        return function($copy_v) {
          var $tco_var_b = $copy_b;
          var $tco_done1 = false;
          var $tco_result;
          function $tco_loop(b, v) {
            if (v instanceof Nil) {
              $tco_done1 = true;
              return b;
            }
            ;
            if (v instanceof Cons) {
              $tco_var_b = f(b)(v.value0);
              $copy_v = v.value1;
              return;
            }
            ;
            throw new Error("Failed pattern match at Data.List.Types (line 111, column 12 - line 113, column 30): " + [v.constructor.name]);
          }
          ;
          while (!$tco_done1) {
            $tco_result = $tco_loop($tco_var_b, $copy_v);
          }
          ;
          return $tco_result;
        };
      };
      return go;
    },
    foldMap: function(dictMonoid) {
      var append22 = append(dictMonoid.Semigroup0());
      var mempty2 = mempty(dictMonoid);
      return function(f) {
        return foldl(foldableList)(function(acc) {
          var $286 = append22(acc);
          return function($287) {
            return $286(f($287));
          };
        })(mempty2);
      };
    }
  };
  var foldr2 = /* @__PURE__ */ foldr(foldableList);
  var semigroupList = {
    append: function(xs) {
      return function(ys) {
        return foldr2(Cons.create)(ys)(xs);
      };
    }
  };
  var append1 = /* @__PURE__ */ append(semigroupList);
  var eq1List = {
    eq1: function(dictEq) {
      var eq6 = eq(dictEq);
      return function(xs) {
        return function(ys) {
          var go = function($copy_v) {
            return function($copy_v1) {
              return function($copy_v2) {
                var $tco_var_v = $copy_v;
                var $tco_var_v1 = $copy_v1;
                var $tco_done = false;
                var $tco_result;
                function $tco_loop(v, v1, v2) {
                  if (!v2) {
                    $tco_done = true;
                    return false;
                  }
                  ;
                  if (v instanceof Nil && v1 instanceof Nil) {
                    $tco_done = true;
                    return v2;
                  }
                  ;
                  if (v instanceof Cons && v1 instanceof Cons) {
                    $tco_var_v = v.value1;
                    $tco_var_v1 = v1.value1;
                    $copy_v2 = v2 && eq6(v1.value0)(v.value0);
                    return;
                  }
                  ;
                  $tco_done = true;
                  return false;
                }
                ;
                while (!$tco_done) {
                  $tco_result = $tco_loop($tco_var_v, $tco_var_v1, $copy_v2);
                }
                ;
                return $tco_result;
              };
            };
          };
          return go(xs)(ys)(true);
        };
      };
    }
  };
  var eq12 = /* @__PURE__ */ eq1(eq1List);
  var eqList = function(dictEq) {
    return {
      eq: eq12(dictEq)
    };
  };
  var applyList = {
    apply: function(v) {
      return function(v1) {
        if (v instanceof Nil) {
          return Nil.value;
        }
        ;
        if (v instanceof Cons) {
          return append1(map4(v.value0)(v1))(apply(applyList)(v.value1)(v1));
        }
        ;
        throw new Error("Failed pattern match at Data.List.Types (line 157, column 1 - line 159, column 48): " + [v.constructor.name, v1.constructor.name]);
      };
    },
    Functor0: function() {
      return functorList;
    }
  };
  var applicativeList = {
    pure: function(a) {
      return new Cons(a, Nil.value);
    },
    Apply0: function() {
      return applyList;
    }
  };

  // output/Data.List/index.js
  var map5 = /* @__PURE__ */ map(functorMaybe);
  var foldr3 = /* @__PURE__ */ foldr(foldableList);
  var snoc2 = function(xs) {
    return function(x) {
      return foldr3(Cons.create)(new Cons(x, Nil.value))(xs);
    };
  };
  var reverse2 = /* @__PURE__ */ function() {
    var go = function($copy_v) {
      return function($copy_v1) {
        var $tco_var_v = $copy_v;
        var $tco_done = false;
        var $tco_result;
        function $tco_loop(v, v1) {
          if (v1 instanceof Nil) {
            $tco_done = true;
            return v;
          }
          ;
          if (v1 instanceof Cons) {
            $tco_var_v = new Cons(v1.value0, v);
            $copy_v1 = v1.value1;
            return;
          }
          ;
          throw new Error("Failed pattern match at Data.List (line 368, column 3 - line 368, column 19): " + [v.constructor.name, v1.constructor.name]);
        }
        ;
        while (!$tco_done) {
          $tco_result = $tco_loop($tco_var_v, $copy_v1);
        }
        ;
        return $tco_result;
      };
    };
    return go(Nil.value);
  }();
  var unsnoc = function(lst) {
    var go = function($copy_v) {
      return function($copy_v1) {
        var $tco_var_v = $copy_v;
        var $tco_done = false;
        var $tco_result;
        function $tco_loop(v, v1) {
          if (v instanceof Nil) {
            $tco_done = true;
            return Nothing.value;
          }
          ;
          if (v instanceof Cons && v.value1 instanceof Nil) {
            $tco_done = true;
            return new Just({
              revInit: v1,
              last: v.value0
            });
          }
          ;
          if (v instanceof Cons) {
            $tco_var_v = v.value1;
            $copy_v1 = new Cons(v.value0, v1);
            return;
          }
          ;
          throw new Error("Failed pattern match at Data.List (line 270, column 3 - line 270, column 21): " + [v.constructor.name, v1.constructor.name]);
        }
        ;
        while (!$tco_done) {
          $tco_result = $tco_loop($tco_var_v, $copy_v1);
        }
        ;
        return $tco_result;
      };
    };
    return map5(function(h) {
      return {
        init: reverse2(h.revInit),
        last: h.last
      };
    })(go(lst)(Nil.value));
  };
  var fromFoldable = function(dictFoldable) {
    return foldr(dictFoldable)(Cons.create)(Nil.value);
  };

  // output/Data.String.Common/foreign.js
  var joinWith = function(s) {
    return function(xs) {
      return xs.join(s);
    };
  };

  // output/Data.String.Regex/foreign.js
  var regexImpl = function(left) {
    return function(right) {
      return function(s1) {
        return function(s2) {
          try {
            return right(new RegExp(s1, s2));
          } catch (e) {
            return left(e.message);
          }
        };
      };
    };
  };
  var test = function(r) {
    return function(s) {
      var lastIndex = r.lastIndex;
      var result = r.test(s);
      r.lastIndex = lastIndex;
      return result;
    };
  };

  // output/Data.String.Regex.Flags/index.js
  var semigroupRegexFlags = {
    append: function(v) {
      return function(v1) {
        return {
          global: v.global || v1.global,
          ignoreCase: v.ignoreCase || v1.ignoreCase,
          multiline: v.multiline || v1.multiline,
          dotAll: v.dotAll || v1.dotAll,
          sticky: v.sticky || v1.sticky,
          unicode: v.unicode || v1.unicode
        };
      };
    }
  };
  var noFlags = {
    global: false,
    ignoreCase: false,
    multiline: false,
    dotAll: false,
    sticky: false,
    unicode: false
  };
  var monoidRegexFlags = {
    mempty: noFlags,
    Semigroup0: function() {
      return semigroupRegexFlags;
    }
  };

  // output/Data.String.Regex/index.js
  var renderFlags = function(v) {
    return function() {
      if (v.global) {
        return "g";
      }
      ;
      return "";
    }() + (function() {
      if (v.ignoreCase) {
        return "i";
      }
      ;
      return "";
    }() + (function() {
      if (v.multiline) {
        return "m";
      }
      ;
      return "";
    }() + (function() {
      if (v.dotAll) {
        return "s";
      }
      ;
      return "";
    }() + (function() {
      if (v.sticky) {
        return "y";
      }
      ;
      return "";
    }() + function() {
      if (v.unicode) {
        return "u";
      }
      ;
      return "";
    }()))));
  };
  var regex = function(s) {
    return function(f) {
      return regexImpl(Left.create)(Right.create)(s)(renderFlags(f));
    };
  };

  // output/Foreign.Object/foreign.js
  function _lookup(no, yes, k, m) {
    return k in m ? yes(m[k]) : no;
  }
  function toArrayWithKey(f) {
    return function(m) {
      var r = [];
      for (var k in m) {
        if (hasOwnProperty.call(m, k)) {
          r.push(f(k)(m[k]));
        }
      }
      return r;
    };
  }
  var keys = Object.keys || toArrayWithKey(function(k) {
    return function() {
      return k;
    };
  });

  // output/Foreign.Object/index.js
  var lookup = /* @__PURE__ */ function() {
    return runFn4(_lookup)(Nothing.value)(Just.create);
  }();

  // output/Partial.Unsafe/foreign.js
  var _unsafePartial = function(f) {
    return f();
  };

  // output/Partial/foreign.js
  var _crashWith = function(msg) {
    throw new Error(msg);
  };

  // output/Partial/index.js
  var crashWith = function() {
    return _crashWith;
  };

  // output/Partial.Unsafe/index.js
  var crashWith2 = /* @__PURE__ */ crashWith();
  var unsafePartial = _unsafePartial;
  var unsafeCrashWith = function(msg) {
    return unsafePartial(function() {
      return crashWith2(msg);
    });
  };

  // output/Utility/index.js
  var void1 = /* @__PURE__ */ $$void(functorEffect);
  var bind1 = /* @__PURE__ */ bind(bindMaybe);
  var pure1 = /* @__PURE__ */ pure(applicativeMaybe);
  var show2 = /* @__PURE__ */ show(showString);
  var writeFlipped = /* @__PURE__ */ flip(write);
  var todo = function() {
    return function(msg) {
      return unsafeCrashWith("[[TODO]]\n" + msg);
    };
  };
  var splitAt_Array = function(v) {
    return function(v1) {
      if (0 <= v && v < length(v1)) {
        return new Just({
          before: take(v)(v1),
          after: drop(v)(v1)
        });
      }
      ;
      return Nothing.value;
    };
  };
  var parens = function(s) {
    return "(" + (s + ")");
  };
  var modifyFlipped = function(r) {
    return function(f) {
      return void1(modify(f)(r));
    };
  };
  var fromMaybeM = function(dictApplicative) {
    var pure23 = pure(dictApplicative);
    return function(v) {
      return function(v1) {
        if (v1 instanceof Nothing) {
          return v;
        }
        ;
        if (v1 instanceof Just) {
          return pure23(v1.value0);
        }
        ;
        throw new Error("Failed pattern match at Utility (line 110, column 1 - line 110, column 56): " + [v.constructor.name, v1.constructor.name]);
      };
    };
  };
  var extractSpan_Array = function(i_L) {
    return function(i_R) {
      return function(xs) {
        var v = splitAt(i_R)(xs);
        var v1 = splitAt(i_L)(v.before);
        return {
          before: v1.before,
          here: v1.after,
          after: v.after
        };
      };
    };
  };
  var extractAt_Array = function(i) {
    return function(xs) {
      return bind1(splitAt_Array(i)(xs))(function(v) {
        return bind1(uncons(v.after))(function(v1) {
          return pure1({
            before: v.before,
            here: v1.head,
            after: v1.tail
          });
        });
      });
    };
  };
  var bug = function(msg) {
    return unsafeCrashWith("[[BUG]]\n" + msg);
  };
  var impossible = function(msg) {
    return function(v) {
      return bug("impossible: " + msg);
    };
  };
  var isAlpha_regex = /* @__PURE__ */ fromRight$prime(/* @__PURE__ */ impossible("isAlpha_regex: failure"))(/* @__PURE__ */ regex("^[a-zA-Z]$")(/* @__PURE__ */ mempty(monoidRegexFlags)));
  var isAlpha = /* @__PURE__ */ test(isAlpha_regex);
  var lookup_unsafe = function(k) {
    return function(a) {
      return fromMaybe$prime(function(v) {
        return bug("Object doesn't have property " + show2(k));
      })(lookup(k)(a));
    };
  };

  // output/Data.Expr/index.js
  var show3 = /* @__PURE__ */ show(showInt);
  var intercalate5 = /* @__PURE__ */ intercalate2(monoidString);
  var append12 = /* @__PURE__ */ append(semigroupArray);
  var map6 = /* @__PURE__ */ map(functorArray);
  var map1 = /* @__PURE__ */ map(functorList);
  var compare2 = /* @__PURE__ */ compare(ordInt);
  var eqRec2 = /* @__PURE__ */ eqRec();
  var eqRowCons2 = /* @__PURE__ */ eqRowCons(eqRowNil)();
  var pathIsSymbol = {
    reflectSymbol: function() {
      return "path";
    }
  };
  var jIsSymbol = {
    reflectSymbol: function() {
      return "j";
    }
  };
  var unwrap2 = /* @__PURE__ */ unwrap();
  var intercalate12 = /* @__PURE__ */ intercalate(foldableList)(monoidString);
  var mapWithIndex4 = /* @__PURE__ */ mapWithIndex(functorWithIndexArray);
  var pure2 = /* @__PURE__ */ pure(applicativeMaybe);
  var empty3 = /* @__PURE__ */ empty(plusMaybe);
  var append2 = /* @__PURE__ */ append(/* @__PURE__ */ semigroupNonEmpty(applicativeList)(semigroupList));
  var OuterLeft_ZipperFocus = /* @__PURE__ */ function() {
    function OuterLeft_ZipperFocus2() {
    }
    ;
    OuterLeft_ZipperFocus2.value = new OuterLeft_ZipperFocus2();
    return OuterLeft_ZipperFocus2;
  }();
  var InnerLeft_ZipperFocus = /* @__PURE__ */ function() {
    function InnerLeft_ZipperFocus2() {
    }
    ;
    InnerLeft_ZipperFocus2.value = new InnerLeft_ZipperFocus2();
    return InnerLeft_ZipperFocus2;
  }();
  var InnerRight_ZipperFocus = /* @__PURE__ */ function() {
    function InnerRight_ZipperFocus2() {
    }
    ;
    InnerRight_ZipperFocus2.value = new InnerRight_ZipperFocus2();
    return InnerRight_ZipperFocus2;
  }();
  var OuterRight_ZipperFocus = /* @__PURE__ */ function() {
    function OuterRight_ZipperFocus2() {
    }
    ;
    OuterRight_ZipperFocus2.value = new OuterRight_ZipperFocus2();
    return OuterRight_ZipperFocus2;
  }();
  var Step = function(x) {
    return x;
  };
  var Left_SpanFocus = /* @__PURE__ */ function() {
    function Left_SpanFocus2() {
    }
    ;
    Left_SpanFocus2.value = new Left_SpanFocus2();
    return Left_SpanFocus2;
  }();
  var Right_SpanFocus = /* @__PURE__ */ function() {
    function Right_SpanFocus2() {
    }
    ;
    Right_SpanFocus2.value = new Right_SpanFocus2();
    return Right_SpanFocus2;
  }();
  var Point_Handle = /* @__PURE__ */ function() {
    function Point_Handle2(value0) {
      this.value0 = value0;
    }
    ;
    Point_Handle2.create = function(value0) {
      return new Point_Handle2(value0);
    };
    return Point_Handle2;
  }();
  var SpanH_Handle = /* @__PURE__ */ function() {
    function SpanH_Handle2(value0, value1) {
      this.value0 = value0;
      this.value1 = value1;
    }
    ;
    SpanH_Handle2.create = function(value0) {
      return function(value1) {
        return new SpanH_Handle2(value0, value1);
      };
    };
    return SpanH_Handle2;
  }();
  var ZipperH_Handle = /* @__PURE__ */ function() {
    function ZipperH_Handle2(value0, value1) {
      this.value0 = value0;
      this.value1 = value1;
    }
    ;
    ZipperH_Handle2.create = function(value0) {
      return function(value1) {
        return new ZipperH_Handle2(value0, value1);
      };
    };
    return ZipperH_Handle2;
  }();
  var Id_Diff = /* @__PURE__ */ function() {
    function Id_Diff2() {
    }
    ;
    Id_Diff2.value = new Id_Diff2();
    return Id_Diff2;
  }();
  var Inject_Diff = /* @__PURE__ */ function() {
    function Inject_Diff2(value0) {
      this.value0 = value0;
    }
    ;
    Inject_Diff2.create = function(value0) {
      return new Inject_Diff2(value0);
    };
    return Inject_Diff2;
  }();
  var DeleteTooth_Diff = /* @__PURE__ */ function() {
    function DeleteTooth_Diff2(value0, value1) {
      this.value0 = value0;
      this.value1 = value1;
    }
    ;
    DeleteTooth_Diff2.create = function(value0) {
      return function(value1) {
        return new DeleteTooth_Diff2(value0, value1);
      };
    };
    return DeleteTooth_Diff2;
  }();
  var InsertTooth_Diff = /* @__PURE__ */ function() {
    function InsertTooth_Diff2(value0, value1) {
      this.value0 = value0;
      this.value1 = value1;
    }
    ;
    InsertTooth_Diff2.create = function(value0) {
      return function(value1) {
        return new InsertTooth_Diff2(value0, value1);
      };
    };
    return InsertTooth_Diff2;
  }();
  var ReplaceSpan_Diff = /* @__PURE__ */ function() {
    function ReplaceSpan_Diff2(value0, value1, value2) {
      this.value0 = value0;
      this.value1 = value1;
      this.value2 = value2;
    }
    ;
    ReplaceSpan_Diff2.create = function(value0) {
      return function(value1) {
        return function(value2) {
          return new ReplaceSpan_Diff2(value0, value1, value2);
        };
      };
    };
    return ReplaceSpan_Diff2;
  }();
  var Replace_Diff = /* @__PURE__ */ function() {
    function Replace_Diff2(value0) {
      this.value0 = value0;
    }
    ;
    Replace_Diff2.create = function(value0) {
      return new Replace_Diff2(value0);
    };
    return Replace_Diff2;
  }();
  var showStep = {
    show: function(v) {
      return "|" + show3(v);
    }
  };
  var show22 = /* @__PURE__ */ show(showStep);
  var showIndex = {
    show: function(v) {
      return "." + show3(v);
    }
  };
  var show4 = /* @__PURE__ */ show(showIndex);
  var showExpr = function(dictShow) {
    var show8 = show(dictShow);
    return {
      show: function(v) {
        if ($$null(v.kids)) {
          return show8(v.l);
        }
        ;
        return parens(intercalate5(" ")(append12([show8(v.l), "%"])(map6(show(showExpr(dictShow)))(v.kids))));
      }
    };
  };
  var semiringIndex = semiringInt;
  var ringIndex = ringInt;
  var genericPoint_ = {
    to: function(x) {
      return x;
    },
    from: function(x) {
      return x;
    }
  };
  var eqStep = {
    eq: function(x) {
      return function(y) {
        return x === y;
      };
    }
  };
  var eqList2 = /* @__PURE__ */ eqList(eqStep);
  var eqRowCons22 = /* @__PURE__ */ eqRowCons(/* @__PURE__ */ eqRowCons2(pathIsSymbol)(eqList2))();
  var eq13 = /* @__PURE__ */ eq(eqStep);
  var notEq2 = /* @__PURE__ */ notEq(eqStep);
  var eq22 = /* @__PURE__ */ eq(eqList2);
  var ordStep = {
    compare: function(x) {
      return function(y) {
        return compare2(x)(y);
      };
    },
    Eq0: function() {
      return eqStep;
    }
  };
  var eqIndex = {
    eq: function(x) {
      return function(y) {
        return x === y;
      };
    }
  };
  var genericEq3 = /* @__PURE__ */ genericEq(genericPoint_)(/* @__PURE__ */ genericEqConstructor(/* @__PURE__ */ genericEqArgument(/* @__PURE__ */ eqRec2(/* @__PURE__ */ eqRowCons22(jIsSymbol)(eqIndex)))));
  var eqPoint = {
    eq: function(x) {
      return genericEq3(x);
    }
  };
  var ordIndex = {
    compare: function(x) {
      return function(y) {
        return compare2(x)(y);
      };
    },
    Eq0: function() {
      return eqIndex;
    }
  };
  var lessThanOrEq1 = /* @__PURE__ */ lessThanOrEq(ordIndex);
  var toNePath = function(v) {
    if (v instanceof Nil) {
      return Nothing.value;
    }
    ;
    if (v instanceof Cons) {
      return new Just(new NonEmpty(v.value0, v.value1));
    }
    ;
    throw new Error("Failed pattern match at Data.Expr (line 209, column 1 - line 209, column 33): " + [v.constructor.name]);
  };
  var show_Path = function(steps) {
    return "[" + (intercalate12(" ")(map1(show22)(steps)) + "]");
  };
  var showPoint = {
    show: function(v) {
      return parens(show_Path(v.path) + (" \u25B3 " + show4(v.j)));
    }
  };
  var rangeSteps = function(i) {
    return map6(Step)(range2(unwrap2(i["_L"]))(unwrap2(i["_R"])));
  };
  var rangeKidSteps = function(v) {
    return mapWithIndex4(function(i) {
      return $$const(i);
    })(v.kids);
  };
  var orderedStepAndIndex = function(v) {
    return function(v1) {
      return v < v1;
    };
  };
  var orderedIndexAndStep = function(v) {
    return function(v1) {
      return v <= v1;
    };
  };
  var offset_Span = function(v) {
    return length(v);
  };
  var mkExpr = function(l) {
    return function(kids) {
      return {
        l,
        kids
      };
    };
  };
  var mapStepsAndKids = function(f) {
    return function(v) {
      return mapWithIndex4(function(i) {
        return f(i);
      })(v.kids);
    };
  };
  var isPrefix_Path = function($copy_v) {
    return function($copy_v1) {
      var $tco_var_v = $copy_v;
      var $tco_done = false;
      var $tco_result;
      function $tco_loop(v, v1) {
        if (v instanceof Nil) {
          $tco_done = true;
          return true;
        }
        ;
        if (v instanceof Cons && (v1 instanceof Cons && eq13(v.value0)(v1.value0))) {
          $tco_var_v = v.value1;
          $copy_v1 = v1.value1;
          return;
        }
        ;
        $tco_done = true;
        return false;
      }
      ;
      while (!$tco_done) {
        $tco_result = $tco_loop($tco_var_v, $copy_v1);
      }
      ;
      return $tco_result;
    };
  };
  var isAncestorSiblingOf_Point = function(v) {
    return function(v1) {
      var go = function($copy_v2) {
        return function($copy_v3) {
          var $tco_var_v2 = $copy_v2;
          var $tco_done = false;
          var $tco_result;
          function $tco_loop(v2, v3) {
            if (v2 instanceof Nil && v3 instanceof Cons) {
              $tco_done = true;
              return pure2(new Tuple(v3.value0, v3.value1));
            }
            ;
            if (v2 instanceof Cons && (v3 instanceof Cons && eq13(v2.value0)(v3.value0))) {
              $tco_var_v2 = v2.value1;
              $copy_v3 = v3.value1;
              return;
            }
            ;
            $tco_done = true;
            return empty3;
          }
          ;
          while (!$tco_done) {
            $tco_result = $tco_loop($tco_var_v2, $copy_v3);
          }
          ;
          return $tco_result;
        };
      };
      return go(v.path)(v1.path);
    };
  };
  var getTotalInnerPath_ZipperH = function(v) {
    if (v.path_O instanceof Nil) {
      return v.path_I;
    }
    ;
    if (v.path_O instanceof Cons) {
      return append2(new NonEmpty(v.path_O.value0, v.path_O.value1))(v.path_I);
    }
    ;
    throw new Error("Failed pattern match at Data.Expr (line 442, column 41 - line 444, column 42): " + [v.path_O.constructor.name]);
  };
  var getStepsAroundIndex = function(v) {
    return {
      "_L": v - 1 | 0,
      "_R": v
    };
  };
  var getStep = function(v) {
    return length(v.kids_L);
  };
  var showDiff = function(dictShow) {
    var show8 = show(showExpr(dictShow));
    return {
      show: function(v) {
        if (v instanceof Id_Diff) {
          return "_";
        }
        ;
        if (v instanceof Inject_Diff) {
          return "(_ % " + (joinWith(" ")(map6(show(showDiff(dictShow)))(v.value0)) + ")");
        }
        ;
        if (v instanceof DeleteTooth_Diff) {
          return "-(_ % ... -[" + (show22(v.value0) + ("]: " + (show(showDiff(dictShow))(v.value1) + " ... )")));
        }
        ;
        if (v instanceof InsertTooth_Diff) {
          return "+(_ % ... +[" + (show22(getStep(v.value0)) + ("]: " + (show(showDiff(dictShow))(v.value1) + " ... )")));
        }
        ;
        if (v instanceof ReplaceSpan_Diff) {
          return "//(_ % ... [" + (show4(v.value0) + ("] " + (joinWith(" ")(map6(show8)(unwrap2(v.value2))) + (" [" + (show4(v.value1) + " ... )")))));
        }
        ;
        if (v instanceof Replace_Diff) {
          return "//" + show8(v.value0);
        }
        ;
        throw new Error("Failed pattern match at Data.Expr (line 565, column 1 - line 571, column 41): " + [v.constructor.name]);
      }
    };
  };
  var getKid_Expr = function(dictShow) {
    return function(v) {
      return function(v1) {
        return index(v1.kids)(v);
      };
    };
  };
  var getIndexesAroundStep = function(v) {
    return {
      "_L": v,
      "_R": v + 1 | 0
    };
  };
  var getExtremeIndexes = function(v) {
    return {
      "_L": 0,
      "_R": length(v.kids)
    };
  };
  var getEndPoints_SpanH = function(v) {
    return {
      "_L": {
        path: v.path,
        j: v.j_L
      },
      "_R": {
        path: v.path,
        j: v.j_R
      }
    };
  };
  var fromNePath = /* @__PURE__ */ fromFoldable(/* @__PURE__ */ foldableNonEmpty(foldableList));
  var getEndPoints_ZipperH = function(v) {
    return {
      "_OL": {
        path: v.path_O,
        j: v.j_OL
      },
      "_IL": {
        path: fromNePath(getTotalInnerPath_ZipperH(v)),
        j: v.j_IL
      },
      "_IR": {
        path: fromNePath(getTotalInnerPath_ZipperH(v)),
        j: v.j_IR
      },
      "_OR": {
        path: v.path_O,
        j: v.j_OR
      }
    };
  };
  var getFocusPoint = function(v) {
    if (v instanceof Point_Handle) {
      return v.value0;
    }
    ;
    if (v instanceof SpanH_Handle && v.value1 instanceof Left_SpanFocus) {
      return {
        path: v.value0.path,
        j: v.value0.j_L
      };
    }
    ;
    if (v instanceof SpanH_Handle && v.value1 instanceof Right_SpanFocus) {
      return {
        path: v.value0.path,
        j: v.value0.j_R
      };
    }
    ;
    if (v instanceof ZipperH_Handle && v.value1 instanceof OuterLeft_ZipperFocus) {
      return {
        path: v.value0.path_O,
        j: v.value0.j_OL
      };
    }
    ;
    if (v instanceof ZipperH_Handle && v.value1 instanceof InnerLeft_ZipperFocus) {
      return {
        path: fromNePath(getTotalInnerPath_ZipperH(v.value0)),
        j: v.value0.j_IL
      };
    }
    ;
    if (v instanceof ZipperH_Handle && v.value1 instanceof InnerRight_ZipperFocus) {
      return {
        path: fromNePath(getTotalInnerPath_ZipperH(v.value0)),
        j: v.value0.j_IR
      };
    }
    ;
    if (v instanceof ZipperH_Handle && v.value1 instanceof OuterRight_ZipperFocus) {
      return {
        path: v.value0.path_O,
        j: v.value0.j_OR
      };
    }
    ;
    throw new Error("Failed pattern match at Data.Expr (line 524, column 1 - line 524, column 33): " + [v.constructor.name]);
  };
  var defaultHandle = /* @__PURE__ */ function() {
    return new Point_Handle({
      path: Nil.value,
      j: 0
    });
  }();
  var atStep = function(dictShow) {
    var show8 = show(showExpr(dictShow));
    return function(i) {
      return function(v) {
        var v1 = fromMaybe$prime(impossible("atStep " + (show22(i) + (" " + show8(v)))))(extractAt_Array(unwrap2(i))(v.kids));
        return {
          outside: {
            l: v.l,
            kids_L: v1.before,
            kids_R: v1.after
          },
          here: v1.here
        };
      };
    };
  };
  var atSubExpr = function(dictShow) {
    var atStep1 = atStep(dictShow);
    var go = function($copy_ts) {
      return function($copy_path) {
        return function($copy_e) {
          var $tco_var_ts = $copy_ts;
          var $tco_var_path = $copy_path;
          var $tco_done = false;
          var $tco_result;
          function $tco_loop(ts, path, e) {
            if (path instanceof Cons) {
              var v = atStep1(path.value0)(e);
              $tco_var_ts = new Cons(v.outside, ts);
              $tco_var_path = path.value1;
              $copy_e = v.here;
              return;
            }
            ;
            if (path instanceof Nil) {
              $tco_done = true;
              return {
                outside: reverse2(ts),
                here: e
              };
            }
            ;
            throw new Error("Failed pattern match at Data.Expr (line 186, column 18 - line 190, column 49): " + [path.constructor.name]);
          }
          ;
          while (!$tco_done) {
            $tco_result = $tco_loop($tco_var_ts, $tco_var_path, $copy_e);
          }
          ;
          return $tco_result;
        };
      };
    };
    return go(Nil.value);
  };
  var atInjectDiff = function(dictShow) {
    return function(v) {
      return function(f) {
        var goStep = function(i) {
          return function(path) {
            return function(e) {
              return new Inject_Diff(mapStepsAndKids(function(i$prime) {
                return function(e$prime) {
                  var $1044 = notEq2(i)(i$prime);
                  if ($1044) {
                    return Id_Diff.value;
                  }
                  ;
                  return go(path)(e$prime);
                };
              })(e));
            };
          };
        };
        var go = function(path) {
          return function(e) {
            if (path instanceof Cons) {
              return goStep(path.value0)(path.value1)(e);
            }
            ;
            if (path instanceof Nil) {
              return f(e);
            }
            ;
            throw new Error("Failed pattern match at Data.Expr (line 577, column 15 - line 579, column 15): " + [path.constructor.name]);
          };
        };
        return goStep(v.value0)(v.value1);
      };
    };
  };
  var atIndexSpan_Expr = function(i_L) {
    return function(i_R) {
      return function(v) {
        var v1 = extractSpan_Array(unwrap2(i_L))(unwrap2(i_R))(v.kids);
        return {
          outside: {
            l: v.l,
            kids_L: v1.before,
            kids_R: v1.after
          },
          here: v1.here
        };
      };
    };
  };
  var areOrderedSiblings_Point = function(v) {
    return function(v1) {
      return eq22(v.path)(v1.path) && lessThanOrEq1(v.j)(v1.j);
    };
  };

  // output/Data.Expr.Drag/index.js
  var eq3 = /* @__PURE__ */ eq(eqPoint);
  var pure3 = /* @__PURE__ */ pure(applicativeMaybe);
  var append3 = /* @__PURE__ */ append(semigroupList);
  var bind2 = /* @__PURE__ */ bind(bindMaybe);
  var getDragOrigin = function(v) {
    return function(v1) {
      var v2 = function(v3) {
        var v4 = function(v5) {
          var v6 = function(v7) {
            var v8 = function(v9) {
              var v10 = function(v11) {
                var v12 = function(v13) {
                  return new Point_Handle(v1);
                };
                if (v instanceof ZipperH_Handle) {
                  var $55 = getEndPoints_ZipperH(v.value0);
                  var $56 = eq3(v1)($55["_OR"]);
                  if ($56) {
                    return new ZipperH_Handle(v.value0, OuterRight_ZipperFocus.value);
                  }
                  ;
                  return v12(true);
                }
                ;
                return v12(true);
              };
              if (v instanceof ZipperH_Handle) {
                var $61 = getEndPoints_ZipperH(v.value0);
                var $62 = eq3(v1)($61["_IR"]);
                if ($62) {
                  return new ZipperH_Handle(v.value0, InnerRight_ZipperFocus.value);
                }
                ;
                return v10(true);
              }
              ;
              return v10(true);
            };
            if (v instanceof ZipperH_Handle) {
              var $67 = getEndPoints_ZipperH(v.value0);
              var $68 = eq3(v1)($67["_IL"]);
              if ($68) {
                return new ZipperH_Handle(v.value0, InnerLeft_ZipperFocus.value);
              }
              ;
              return v8(true);
            }
            ;
            return v8(true);
          };
          if (v instanceof ZipperH_Handle) {
            var $73 = getEndPoints_ZipperH(v.value0);
            var $74 = eq3(v1)($73["_OL"]);
            if ($74) {
              return new ZipperH_Handle(v.value0, OuterLeft_ZipperFocus.value);
            }
            ;
            return v6(true);
          }
          ;
          return v6(true);
        };
        if (v instanceof SpanH_Handle) {
          var $79 = getEndPoints_SpanH(v.value0);
          var $80 = eq3(v1)($79["_R"]);
          if ($80) {
            return new SpanH_Handle(v.value0, Right_SpanFocus.value);
          }
          ;
          return v4(true);
        }
        ;
        return v4(true);
      };
      if (v instanceof SpanH_Handle) {
        var $85 = getEndPoints_SpanH(v.value0);
        var $86 = eq3(v1)($85["_L"]);
        if ($86) {
          return new SpanH_Handle(v.value0, Left_SpanFocus.value);
        }
        ;
        return v2(true);
      }
      ;
      return v2(true);
    };
  };
  var drag = function(dictShow) {
    var atSubExpr3 = atSubExpr(dictShow);
    return function(v) {
      return function(v1) {
        return function(v2) {
          if (v instanceof Point_Handle) {
            if (eq3(v.value0)(v1)) {
              return pure3(new Point_Handle(v1));
            }
            ;
            if (areOrderedSiblings_Point(v.value0)(v1)) {
              return pure3(new SpanH_Handle({
                path: v.value0.path,
                j_L: v.value0.j,
                j_R: v1.j
              }, Right_SpanFocus.value));
            }
            ;
            if (areOrderedSiblings_Point(v1)(v.value0)) {
              return pure3(new SpanH_Handle({
                path: v.value0.path,
                j_L: v1.j,
                j_R: v.value0.j
              }, Left_SpanFocus.value));
            }
            ;
            var v3 = function(v4) {
              var v5 = function(v6) {
                var v7 = function(v8) {
                  var v9 = function(v10) {
                    if (otherwise) {
                      return Nothing.value;
                    }
                    ;
                    throw new Error("Failed pattern match at Data.Expr.Drag (line 20, column 1 - line 20, column 70): " + [unit.constructor.name]);
                  };
                  var $97 = isAncestorSiblingOf_Point(v.value0)(v1);
                  if ($97 instanceof Just) {
                    var $98 = orderedStepAndIndex($97.value0.value0)(v.value0.j);
                    if ($98) {
                      var path_I4 = new NonEmpty($97.value0.value0, $97.value0.value1);
                      return pure3(new ZipperH_Handle({
                        path_O: v.value0.path,
                        j_OL: function(v10) {
                          return v10["_L"];
                        }(getIndexesAroundStep($97.value0.value0)),
                        j_OR: v.value0.j,
                        path_I: path_I4,
                        j_IL: function(v10) {
                          return v10["_L"];
                        }(getExtremeIndexes(function(v10) {
                          return v10.here;
                        }(atSubExpr3(append3(v.value0.path)(fromNePath(path_I4)))(v2)))),
                        j_IR: v1.j
                      }, InnerRight_ZipperFocus.value));
                    }
                    ;
                    return v9(true);
                  }
                  ;
                  return v9(true);
                };
                var $105 = isAncestorSiblingOf_Point(v.value0)(v1);
                if ($105 instanceof Just) {
                  var $106 = orderedIndexAndStep(v.value0.j)($105.value0.value0);
                  if ($106) {
                    var path_I3 = new NonEmpty($105.value0.value0, $105.value0.value1);
                    return pure3(new ZipperH_Handle({
                      path_O: v.value0.path,
                      j_OL: v.value0.j,
                      j_OR: function(v8) {
                        return v8["_R"];
                      }(getIndexesAroundStep($105.value0.value0)),
                      path_I: path_I3,
                      j_IL: v1.j,
                      j_IR: function(v8) {
                        return v8["_R"];
                      }(getExtremeIndexes(function(v8) {
                        return v8.here;
                      }(atSubExpr3(append3(v.value0.path)(fromNePath(path_I3)))(v2))))
                    }, InnerLeft_ZipperFocus.value));
                  }
                  ;
                  return v7(true);
                }
                ;
                return v7(true);
              };
              var $113 = isAncestorSiblingOf_Point(v1)(v.value0);
              if ($113 instanceof Just) {
                var $114 = orderedStepAndIndex($113.value0.value0)(v1.j);
                if ($114) {
                  var path_I2 = new NonEmpty($113.value0.value0, $113.value0.value1);
                  return pure3(new ZipperH_Handle({
                    path_O: v1.path,
                    j_OL: function(v6) {
                      return v6["_L"];
                    }(getIndexesAroundStep($113.value0.value0)),
                    j_OR: v1.j,
                    path_I: path_I2,
                    j_IL: function(v6) {
                      return v6["_L"];
                    }(getExtremeIndexes(function(v6) {
                      return v6.here;
                    }(atSubExpr3(append3(v1.path)(fromNePath(path_I2)))(v2)))),
                    j_IR: v.value0.j
                  }, OuterRight_ZipperFocus.value));
                }
                ;
                return v5(true);
              }
              ;
              return v5(true);
            };
            var $121 = isAncestorSiblingOf_Point(v1)(v.value0);
            if ($121 instanceof Just) {
              var $122 = orderedIndexAndStep(v1.j)($121.value0.value0);
              if ($122) {
                var path_I = new NonEmpty($121.value0.value0, $121.value0.value1);
                return pure3(new ZipperH_Handle({
                  path_O: v1.path,
                  j_OL: v1.j,
                  j_OR: function(v4) {
                    return v4["_R"];
                  }(getIndexesAroundStep($121.value0.value0)),
                  path_I,
                  j_IL: v.value0.j,
                  j_IR: function(v4) {
                    return v4["_R"];
                  }(getExtremeIndexes(function(v4) {
                    return v4.here;
                  }(atSubExpr3(append3(v1.path)(fromNePath(path_I)))(v2))))
                }, OuterLeft_ZipperFocus.value));
              }
              ;
              return v3(true);
            }
            ;
            return v3(true);
          }
          ;
          if (v instanceof SpanH_Handle) {
            var hp = getEndPoints_SpanH(v.value0);
            if (v.value1 instanceof Right_SpanFocus) {
              return drag(dictShow)(new Point_Handle(hp["_L"]))(v1)(v2);
            }
            ;
            if (v.value1 instanceof Left_SpanFocus) {
              return drag(dictShow)(new Point_Handle(hp["_R"]))(v1)(v2);
            }
            ;
            throw new Error("Failed pattern match at Data.Expr.Drag (line 89, column 52 - line 91, column 59): " + [v.value1.constructor.name]);
          }
          ;
          if (v instanceof ZipperH_Handle) {
            var hp = getEndPoints_ZipperH(v.value0);
            var h_path_I = fromNePath(getTotalInnerPath_ZipperH(v.value0));
            if (v.value1 instanceof OuterLeft_ZipperFocus && isPrefix_Path(v1.path)(h_path_I)) {
              return bind2(drag(dictShow)(new Point_Handle(hp["_IL"]))(v1)(v2))(function(v32) {
                if (v32 instanceof ZipperH_Handle) {
                  return pure3(new ZipperH_Handle({
                    path_O: v32.value0.path_O,
                    j_OL: v32.value0.j_OL,
                    path_I: v32.value0.path_I,
                    j_IL: v.value0.j_IL,
                    j_IR: v.value0.j_IR,
                    j_OR: function() {
                      var $132 = areOrderedSiblings_Point(v1)({
                        path: v.value0.path_O,
                        j: getIndexesAroundStep(head(v.value0.path_I))["_L"]
                      });
                      if ($132) {
                        return v.value0.j_OR;
                      }
                      ;
                      return v32.value0.j_OR;
                    }()
                  }, v32.value1));
                }
                ;
                return new Just(v32);
              });
            }
            ;
            if (v.value1 instanceof OuterRight_ZipperFocus && isPrefix_Path(v1.path)(h_path_I)) {
              return bind2(drag(dictShow)(new Point_Handle(hp["_IR"]))(v1)(v2))(function(v32) {
                if (v32 instanceof ZipperH_Handle) {
                  return pure3(new ZipperH_Handle({
                    path_O: v32.value0.path_O,
                    j_OR: v32.value0.j_OR,
                    path_I: v32.value0.path_I,
                    j_IL: v.value0.j_IL,
                    j_IR: v.value0.j_IR,
                    j_OL: function() {
                      var $136 = areOrderedSiblings_Point({
                        path: v.value0.path_O,
                        j: getIndexesAroundStep(head(v.value0.path_I))["_R"]
                      })(v1);
                      if ($136) {
                        return v.value0.j_OL;
                      }
                      ;
                      return v32.value0.j_OL;
                    }()
                  }, v32.value1));
                }
                ;
                return new Just(v32);
              });
            }
            ;
            if (v.value1 instanceof InnerLeft_ZipperFocus && isPrefix_Path(v.value0.path_O)(v1.path)) {
              return bind2(drag(dictShow)(new Point_Handle(hp["_OL"]))(v1)(v2))(function(v32) {
                if (v32 instanceof ZipperH_Handle) {
                  return pure3(new ZipperH_Handle({
                    path_O: v32.value0.path_O,
                    path_I: v32.value0.path_I,
                    j_IL: v32.value0.j_IL,
                    j_OL: v.value0.j_OL,
                    j_OR: v.value0.j_OR,
                    j_IR: function() {
                      var $140 = areOrderedSiblings_Point(v1)(hp["_IR"]);
                      if ($140) {
                        return v.value0.j_IR;
                      }
                      ;
                      return v32.value0.j_IR;
                    }()
                  }, v32.value1));
                }
                ;
                return new Just(v32);
              });
            }
            ;
            if (v.value1 instanceof InnerRight_ZipperFocus && isPrefix_Path(v.value0.path_O)(v1.path)) {
              return bind2(drag(dictShow)(new Point_Handle(hp["_OR"]))(v1)(v2))(function(v32) {
                if (v32 instanceof ZipperH_Handle) {
                  return pure3(new ZipperH_Handle({
                    path_O: v32.value0.path_O,
                    path_I: v32.value0.path_I,
                    j_IR: v32.value0.j_IR,
                    j_OL: v.value0.j_OL,
                    j_OR: v.value0.j_OR,
                    j_IL: function() {
                      var $144 = areOrderedSiblings_Point(hp["_IL"])(v1);
                      if ($144) {
                        return v.value0.j_IL;
                      }
                      ;
                      return v32.value0.j_IL;
                    }()
                  }, v32.value1));
                }
                ;
                return new Just(v32);
              });
            }
            ;
            return Nothing.value;
          }
          ;
          throw new Error("Failed pattern match at Data.Expr.Drag (line 20, column 1 - line 20, column 70): " + [v.constructor.name, v1.constructor.name, v2.constructor.name]);
        };
      };
    };
  };

  // output/Data.Expr.Move/index.js
  var lessThan2 = /* @__PURE__ */ lessThan(ordIndex);
  var append4 = /* @__PURE__ */ append(semigroupList);
  var add2 = /* @__PURE__ */ add(semiringIndex);
  var wrap2 = /* @__PURE__ */ wrap();
  var eq4 = /* @__PURE__ */ eq(eqIndex);
  var sub2 = /* @__PURE__ */ sub(ringIndex);
  var pure4 = /* @__PURE__ */ pure(applicativeMaybe);
  var L = /* @__PURE__ */ function() {
    function L3() {
    }
    ;
    L3.value = new L3();
    return L3;
  }();
  var R = /* @__PURE__ */ function() {
    function R2() {
    }
    ;
    R2.value = new R2();
    return R2;
  }();
  var moveZipperFocus = function(v) {
    return function(v1) {
      if (v instanceof L && v1 instanceof OuterLeft_ZipperFocus) {
        return OuterRight_ZipperFocus.value;
      }
      ;
      if (v instanceof L && v1 instanceof OuterRight_ZipperFocus) {
        return InnerRight_ZipperFocus.value;
      }
      ;
      if (v instanceof L && v1 instanceof InnerRight_ZipperFocus) {
        return InnerLeft_ZipperFocus.value;
      }
      ;
      if (v instanceof L && v1 instanceof InnerLeft_ZipperFocus) {
        return OuterLeft_ZipperFocus.value;
      }
      ;
      if (v instanceof R && v1 instanceof OuterLeft_ZipperFocus) {
        return InnerLeft_ZipperFocus.value;
      }
      ;
      if (v instanceof R && v1 instanceof InnerLeft_ZipperFocus) {
        return InnerRight_ZipperFocus.value;
      }
      ;
      if (v instanceof R && v1 instanceof InnerRight_ZipperFocus) {
        return OuterRight_ZipperFocus.value;
      }
      ;
      if (v instanceof R && v1 instanceof OuterRight_ZipperFocus) {
        return OuterLeft_ZipperFocus.value;
      }
      ;
      throw new Error("Failed pattern match at Data.Expr.Move (line 63, column 1 - line 63, column 53): " + [v.constructor.name, v1.constructor.name]);
    };
  };
  var moveSpanFocus = function(v) {
    return function(v1) {
      if (v1 instanceof Left_SpanFocus) {
        return Right_SpanFocus.value;
      }
      ;
      if (v1 instanceof Right_SpanFocus) {
        return Left_SpanFocus.value;
      }
      ;
      throw new Error("Failed pattern match at Data.Expr.Move (line 59, column 1 - line 59, column 47): " + [v.constructor.name, v1.constructor.name]);
    };
  };
  var movePoint = function(dictShow) {
    var atSubExpr3 = atSubExpr(dictShow);
    var getKid_Expr3 = getKid_Expr(dictShow);
    return function(e) {
      return function(dir) {
        return function(v) {
          var at_e = atSubExpr3(v.path)(e);
          var extreme_j = getExtremeIndexes(at_e.here);
          var v1 = function(v2) {
            var v3 = function(v4) {
              var v5 = function(v6) {
                var v7 = function(v8) {
                  var v9 = function(v10) {
                    var v11 = function(v12) {
                      return Nothing.value;
                    };
                    if (dir instanceof R) {
                      var $65 = lessThan2(v.j)(extreme_j["_R"]);
                      if ($65) {
                        var $66 = getStepsAroundIndex(v.j)["_R"];
                        var $67 = getKid_Expr3($66)(at_e.here);
                        if ($67 instanceof Just) {
                          return new Just({
                            path: append4(v.path)(new Cons($66, Nil.value)),
                            j: getExtremeIndexes($67.value0)["_L"]
                          });
                        }
                        ;
                        return v11(true);
                      }
                      ;
                      return v11(true);
                    }
                    ;
                    return v11(true);
                  };
                  if (dir instanceof R) {
                    var $70 = lessThan2(v.j)(extreme_j["_R"]);
                    if ($70) {
                      var $71 = getStepsAroundIndex(v.j)["_R"];
                      var $72 = getKid_Expr3($71)(at_e.here);
                      if ($72 instanceof Nothing) {
                        return new Just({
                          path: v.path,
                          j: add2(v.j)(wrap2(1))
                        });
                      }
                      ;
                      return v9(true);
                    }
                    ;
                    return v9(true);
                  }
                  ;
                  return v9(true);
                };
                if (dir instanceof R) {
                  var $74 = eq4(v.j)(extreme_j["_R"]);
                  if ($74) {
                    var $75 = unsnoc(v.path);
                    if ($75 instanceof Just) {
                      return new Just({
                        path: $75.value0.init,
                        j: getIndexesAroundStep($75.value0.last)["_R"]
                      });
                    }
                    ;
                    return v7(true);
                  }
                  ;
                  return v7(true);
                }
                ;
                return v7(true);
              };
              if (dir instanceof L) {
                var $80 = lessThan2(extreme_j["_L"])(v.j);
                if ($80) {
                  var $81 = getStepsAroundIndex(v.j)["_L"];
                  var $82 = getKid_Expr3($81)(at_e.here);
                  if ($82 instanceof Nothing) {
                    return new Just({
                      path: v.path,
                      j: sub2(v.j)(wrap2(1))
                    });
                  }
                  ;
                  return v5(true);
                }
                ;
                return v5(true);
              }
              ;
              return v5(true);
            };
            if (dir instanceof L) {
              var $84 = lessThan2(extreme_j["_L"])(v.j);
              if ($84) {
                var $85 = getStepsAroundIndex(v.j)["_L"];
                var $86 = getKid_Expr3($85)(at_e.here);
                if ($86 instanceof Just) {
                  return new Just({
                    path: append4(v.path)(new Cons($85, Nil.value)),
                    j: getExtremeIndexes($86.value0)["_R"]
                  });
                }
                ;
                return v3(true);
              }
              ;
              return v3(true);
            }
            ;
            return v3(true);
          };
          if (dir instanceof L) {
            var $89 = eq4(extreme_j["_L"])(v.j);
            if ($89) {
              var $90 = unsnoc(v.path);
              if ($90 instanceof Just) {
                return new Just({
                  path: $90.value0.init,
                  j: getIndexesAroundStep($90.value0.last)["_L"]
                });
              }
              ;
              return v1(true);
            }
            ;
            return v1(true);
          }
          ;
          return v1(true);
        };
      };
    };
  };
  var movePointUntil = function(dictShow) {
    var movePoint1 = movePoint(dictShow);
    return function(e) {
      return function(dir) {
        return function(h) {
          return function(f) {
            var go = function($copy_p) {
              var $tco_done = false;
              var $tco_result;
              function $tco_loop(p) {
                var v2 = f(p);
                if (v2 instanceof Nothing) {
                  var v1 = movePoint1(e)(dir)(p);
                  if (v1 instanceof Nothing) {
                    $tco_done = true;
                    return Nothing.value;
                  }
                  ;
                  if (v1 instanceof Just) {
                    $copy_p = v1.value0;
                    return;
                  }
                  ;
                  throw new Error("Failed pattern match at Data.Expr.Move (line 35, column 16 - line 37, column 23): " + [v1.constructor.name]);
                }
                ;
                if (v2 instanceof Just) {
                  $tco_done = true;
                  return pure4(v2.value0);
                }
                ;
                throw new Error("Failed pattern match at Data.Expr.Move (line 34, column 10 - line 38, column 21): " + [v2.constructor.name]);
              }
              ;
              while (!$tco_done) {
                $tco_result = $tco_loop($copy_p);
              }
              ;
              return $tco_result;
            };
            var v = movePoint1(e)(dir)(h);
            if (v instanceof Nothing) {
              return Nothing.value;
            }
            ;
            if (v instanceof Just) {
              return go(v.value0);
            }
            ;
            throw new Error("Failed pattern match at Data.Expr.Move (line 30, column 28 - line 32, column 17): " + [v.constructor.name]);
          };
        };
      };
    };
  };
  var moveHandleFocus = function(v) {
    return function(v1) {
      if (v1 instanceof Point_Handle) {
        return new Point_Handle(v1.value0);
      }
      ;
      if (v1 instanceof SpanH_Handle) {
        return new SpanH_Handle(v1.value0, moveSpanFocus(v)(v1.value1));
      }
      ;
      if (v1 instanceof ZipperH_Handle) {
        return new ZipperH_Handle(v1.value0, moveZipperFocus(v)(v1.value1));
      }
      ;
      throw new Error("Failed pattern match at Data.Expr.Move (line 54, column 1 - line 54, column 43): " + [v.constructor.name, v1.constructor.name]);
    };
  };
  var fromKeyToDir = function(v) {
    if (v === "ArrowLeft") {
      return new Just(L.value);
    }
    ;
    if (v === "ArrowRight") {
      return new Just(R.value);
    }
    ;
    return Nothing.value;
  };

  // output/Data.Trident/index.js
  var First2 = /* @__PURE__ */ function() {
    function First3(value0) {
      this.value0 = value0;
    }
    ;
    First3.create = function(value0) {
      return new First3(value0);
    };
    return First3;
  }();
  var Second = /* @__PURE__ */ function() {
    function Second2(value0) {
      this.value0 = value0;
    }
    ;
    Second2.create = function(value0) {
      return new Second2(value0);
    };
    return Second2;
  }();
  var Third = /* @__PURE__ */ function() {
    function Third2(value0) {
      this.value0 = value0;
    }
    ;
    Third2.create = function(value0) {
      return new Third2(value0);
    };
    return Third2;
  }();

  // output/Editor.Example.Editor1/index.js
  var Root = /* @__PURE__ */ function() {
    function Root2() {
    }
    ;
    Root2.value = new Root2();
    return Root2;
  }();
  var $$String = /* @__PURE__ */ function() {
    function $$String2(value0) {
      this.value0 = value0;
    }
    ;
    $$String2.create = function(value0) {
      return new $$String2(value0);
    };
    return $$String2;
  }();
  var L2 = function(x) {
    return x;
  };
  var showDat = {
    show: function(v) {
      if (v instanceof Root) {
        return "#Root";
      }
      ;
      if (v instanceof $$String) {
        return v.value0;
      }
      ;
      throw new Error("Failed pattern match at Editor.Example.Editor1 (line 31, column 1 - line 33, column 22): " + [v.constructor.name]);
    }
  };
  var show5 = /* @__PURE__ */ show(showDat);
  var showL = {
    show: function(v) {
      return show5(v.dat);
    }
  };
  var mkL = function(dat) {
    return function(meta) {
      return {
        dat,
        meta
      };
    };
  };

  // output/Effect.Console/foreign.js
  var log = function(s) {
    return function() {
      console.log(s);
    };
  };

  // output/Effect.Console/index.js
  var logShow = function(dictShow) {
    var show7 = show(dictShow);
    return function(a) {
      return log(show7(a));
    };
  };

  // output/Effect.Class.Console/index.js
  var logShow2 = function(dictMonadEffect) {
    var liftEffect2 = liftEffect(dictMonadEffect);
    return function(dictShow) {
      var $65 = logShow(dictShow);
      return function($66) {
        return liftEffect2($65($66));
      };
    };
  };
  var log2 = function(dictMonadEffect) {
    var $67 = liftEffect(dictMonadEffect);
    return function($68) {
      return $67(log($68));
    };
  };

  // output/Ui.Element/foreign.js
  var htmlDoc = document;
  var htmlBody = document.body;
  var setText = (text) => (e) => () => {
    e.innerText = text;
  };
  var removeAllChildren = (e) => () => {
    while (e.firstChild) {
      e.remove(e.firstChild);
    }
  };

  // output/Web.DOM.DOMTokenList/foreign.js
  function add3(list) {
    return function(token) {
      return function() {
        return list.add(token);
      };
    };
  }
  function remove(list) {
    return function(token) {
      return function() {
        return list.remove(token);
      };
    };
  }

  // output/Web.DOM.Document/foreign.js
  var getEffProp = function(name2) {
    return function(doc2) {
      return function() {
        return doc2[name2];
      };
    };
  };
  var url = getEffProp("URL");
  var documentURI = getEffProp("documentURI");
  var origin = getEffProp("origin");
  var compatMode = getEffProp("compatMode");
  var characterSet = getEffProp("characterSet");
  var contentType = getEffProp("contentType");
  var _documentElement = getEffProp("documentElement");
  function createElement(localName2) {
    return function(doc2) {
      return function() {
        return doc2.createElement(localName2);
      };
    };
  }

  // output/Web.DOM.Document/index.js
  var toEventTarget = unsafeCoerce2;

  // output/Web.DOM.Element/foreign.js
  var getProp = function(name2) {
    return function(doctype) {
      return doctype[name2];
    };
  };
  var _namespaceURI = getProp("namespaceURI");
  var _prefix = getProp("prefix");
  var localName = getProp("localName");
  var tagName = getProp("tagName");
  function classList(element) {
    return function() {
      return element.classList;
    };
  }

  // output/Web.DOM.ParentNode/foreign.js
  var getEffProp2 = function(name2) {
    return function(node) {
      return function() {
        return node[name2];
      };
    };
  };
  var children = getEffProp2("children");
  var _firstElementChild = getEffProp2("firstElementChild");
  var _lastElementChild = getEffProp2("lastElementChild");
  var childElementCount = getEffProp2("childElementCount");

  // output/Web.DOM.Element/index.js
  var toNode = unsafeCoerce2;
  var toEventTarget2 = unsafeCoerce2;

  // output/Web.DOM.Node/foreign.js
  var getEffProp3 = function(name2) {
    return function(node) {
      return function() {
        return node[name2];
      };
    };
  };
  var baseURI = getEffProp3("baseURI");
  var _ownerDocument = getEffProp3("ownerDocument");
  var _parentNode = getEffProp3("parentNode");
  var _parentElement = getEffProp3("parentElement");
  var childNodes = getEffProp3("childNodes");
  var _firstChild = getEffProp3("firstChild");
  var _lastChild = getEffProp3("lastChild");
  var _previousSibling = getEffProp3("previousSibling");
  var _nextSibling = getEffProp3("nextSibling");
  var _nodeValue = getEffProp3("nodeValue");
  var textContent = getEffProp3("textContent");
  function setTextContent(value) {
    return function(node) {
      return function() {
        node.textContent = value;
      };
    };
  }
  function appendChild(node) {
    return function(parent) {
      return function() {
        parent.appendChild(node);
      };
    };
  }
  function replaceChild(newChild) {
    return function(oldChild) {
      return function(parent) {
        return function() {
          parent.replaceChild(newChild, oldChild);
        };
      };
    };
  }
  function removeChild(node) {
    return function(parent) {
      return function() {
        parent.removeChild(node);
      };
    };
  }

  // output/Web.HTML.HTMLBodyElement/index.js
  var toElement = unsafeCoerce2;

  // output/Web.HTML.HTMLDocument/index.js
  var toDocument = unsafeCoerce2;

  // output/Ui.Element/index.js
  var replaceChild2 = function(old_child) {
    return function(new_child) {
      return function(parent) {
        return replaceChild(toNode(new_child))(toNode(old_child))(toNode(parent));
      };
    };
  };
  var removeClass = function(c) {
    return function(elem3) {
      return function __do2() {
        var v = classList(elem3)();
        return remove(v)(c)();
      };
    };
  };
  var removeChild2 = function(child) {
    return function(parent) {
      return removeChild(toNode(child))(toNode(parent));
    };
  };
  var doc = /* @__PURE__ */ toDocument(htmlDoc);
  var create = function(tag) {
    return createElement(tag)(doc);
  };
  var body = /* @__PURE__ */ toElement(htmlBody);
  var appendChild2 = function(child) {
    return function(parent) {
      return appendChild(toNode(child))(toNode(parent));
    };
  };
  var createChild = function(tag) {
    return function(parent) {
      return function __do2() {
        var elem3 = createElement(tag)(doc)();
        appendChild2(elem3)(parent)();
        return elem3;
      };
    };
  };
  var addClass = function(c) {
    return function(elem3) {
      return function __do2() {
        var v = classList(elem3)();
        return add3(v)(c)();
      };
    };
  };

  // output/Record.Unsafe.Union/foreign.js
  function unsafeUnionFn(r1, r2) {
    var copy = {};
    for (var k1 in r2) {
      if ({}.hasOwnProperty.call(r2, k1)) {
        copy[k1] = r2[k1];
      }
    }
    for (var k2 in r1) {
      if ({}.hasOwnProperty.call(r1, k2)) {
        copy[k2] = r1[k2];
      }
    }
    return copy;
  }

  // output/Record/index.js
  var merge = function() {
    return function() {
      return function(l) {
        return function(r) {
          return unsafeUnionFn(l, r);
        };
      };
    };
  };
  var $$delete2 = function(dictIsSymbol) {
    var reflectSymbol2 = reflectSymbol(dictIsSymbol);
    return function() {
      return function() {
        return function(l) {
          return function(r) {
            return unsafeDelete(reflectSymbol2(l))(r);
          };
        };
      };
    };
  };

  // output/Web.Event.EventTarget/foreign.js
  function eventListener(fn) {
    return function() {
      return function(event) {
        return fn(event)();
      };
    };
  }
  function addEventListenerWithOptions(type) {
    return function(listener) {
      return function(options) {
        return function(target) {
          return function() {
            return target.addEventListener(type, listener, options);
          };
        };
      };
    };
  }
  function removeEventListener(type) {
    return function(listener) {
      return function(useCapture) {
        return function(target) {
          return function() {
            return target.removeEventListener(type, listener, useCapture);
          };
        };
      };
    };
  }

  // output/Ui.Event/index.js
  var keyIsSymbol = {
    reflectSymbol: function() {
      return "key";
    }
  };
  var merge2 = /* @__PURE__ */ merge()();
  var $$delete3 = /* @__PURE__ */ $$delete2(keyIsSymbol)()();
  var bind3 = /* @__PURE__ */ bind(bindMaybe);
  var discard2 = /* @__PURE__ */ discard(discardUnit);
  var discard1 = /* @__PURE__ */ discard2(bindMaybe);
  var guard2 = /* @__PURE__ */ guard(alternativeMaybe);
  var and2 = /* @__PURE__ */ and(foldableArray)(heytingAlgebraBoolean);
  var pure5 = /* @__PURE__ */ pure(applicativeMaybe);
  var shiftKey = /* @__PURE__ */ lookup_unsafe("shiftKey");
  var removeEventListener2 = function(v) {
    return function(target) {
      return removeEventListener(v.eventType)(v.eventListener)(v.options.capture)(target);
    };
  };
  var metaKey = /* @__PURE__ */ lookup_unsafe("metaKey");
  var matchMapKeyInfo = function() {
    return function() {
      return function(f) {
        return function(r_) {
          return function(v) {
            var r$prime = $$delete3($$Proxy.value)(v);
            var r = merge2(r_)({
              cmd: Nothing.value,
              shift: Nothing.value,
              alt: Nothing.value
            });
            return bind3(f(v.key))(function(a) {
              return discard1(guard2(and2([maybe(true)(function(v1) {
                return r$prime.cmd === v1;
              })(r.cmd), maybe(true)(function(v1) {
                return r$prime.shift === v1;
              })(r.shift), maybe(true)(function(v1) {
                return r$prime.alt === v1;
              })(r.alt)])))(function() {
                return pure5(a);
              });
            });
          };
        };
      };
    };
  };
  var matchKeyInfo = function() {
    return function() {
      return function(f) {
        return function(r_) {
          return function(v) {
            var r$prime = $$delete3($$Proxy.value)(v);
            var r = merge2(r_)({
              cmd: Nothing.value,
              shift: Nothing.value,
              alt: Nothing.value
            });
            return and2([f(v.key), maybe(true)(function(v1) {
              return r$prime.cmd === v1;
            })(r.cmd), maybe(true)(function(v1) {
              return r$prime.shift === v1;
            })(r.shift)]);
          };
        };
      };
    };
  };
  var key = /* @__PURE__ */ lookup_unsafe("key");
  var ctrlKey = /* @__PURE__ */ lookup_unsafe("ctrlKey");
  var altKey = /* @__PURE__ */ lookup_unsafe("altKey");
  var fromEventToKeyInfo = function(e) {
    return {
      key: key(e),
      cmd: ctrlKey(e) || metaKey(e),
      alt: altKey(e),
      shift: shiftKey(e)
    };
  };
  var addEventListenerWithOptions2 = function() {
    return function() {
      return function(eventType) {
        return function(options) {
          return function(callback) {
            return function(target) {
              var options$prime = merge2(options)({
                capture: false,
                once: false,
                passive: false
              });
              return function __do2() {
                var eventListener2 = eventListener(callback)();
                addEventListenerWithOptions(eventType)(eventListener2)(options$prime)(target)();
                return {
                  eventType,
                  eventListener: eventListener2,
                  options: options$prime
                };
              };
            };
          };
        };
      };
    };
  };

  // output/Web.Event.Event/foreign.js
  function preventDefault(e) {
    return function() {
      return e.preventDefault();
    };
  }

  // output/Ui.App/index.js
  var discard3 = /* @__PURE__ */ discard(discardUnit);
  var bindReaderT2 = /* @__PURE__ */ bindReaderT(bindEffect);
  var discard12 = /* @__PURE__ */ discard3(bindReaderT2);
  var lift4 = /* @__PURE__ */ lift(monadTransReaderT)(monadEffect);
  var unwrap3 = /* @__PURE__ */ unwrap();
  var traverse_2 = /* @__PURE__ */ traverse_(applicativeEffect)(foldableArray);
  var modify5 = /* @__PURE__ */ modify2();
  var bind4 = /* @__PURE__ */ bind(bindReaderT2);
  var applicativeReaderT2 = /* @__PURE__ */ applicativeReaderT(applicativeEffect);
  var traverseWithIndex2 = /* @__PURE__ */ traverseWithIndex(traversableWithIndexArray)(applicativeReaderT2);
  var pure6 = /* @__PURE__ */ pure(applicativeReaderT2);
  var ask2 = /* @__PURE__ */ ask(/* @__PURE__ */ monadAskReaderT(monadEffect));
  var atSubExpr2 = /* @__PURE__ */ atSubExpr(showL);
  var fromMaybeM2 = /* @__PURE__ */ fromMaybeM(applicativeReaderT2);
  var todo2 = /* @__PURE__ */ todo();
  var addEventListenerWithOptions1 = /* @__PURE__ */ addEventListenerWithOptions2()();
  var log3 = /* @__PURE__ */ log2(/* @__PURE__ */ monadEffectReader(monadEffectEffect));
  var show6 = /* @__PURE__ */ show(showPoint);
  var sequence2 = /* @__PURE__ */ sequence(traversableArray);
  var sequence12 = /* @__PURE__ */ sequence2(applicativeReaderT2);
  var pure22 = /* @__PURE__ */ pure(applicativeMaybe);
  var drag2 = /* @__PURE__ */ drag(showL);
  var sequence22 = /* @__PURE__ */ sequence2(applicativeEffect);
  var when2 = /* @__PURE__ */ when(applicativeReaderT2);
  var show1 = /* @__PURE__ */ show(showL);
  var over2 = /* @__PURE__ */ over()();
  var traverse2 = /* @__PURE__ */ traverse(traversableArray)(applicativeReaderT2);
  var showExpr2 = /* @__PURE__ */ showExpr(showL);
  var show23 = /* @__PURE__ */ show(showExpr2);
  var getKid_Expr2 = /* @__PURE__ */ getKid_Expr(showL);
  var traverseWithIndex_2 = /* @__PURE__ */ traverseWithIndex_(applicativeReaderT2)(foldableWithIndexArray);
  var notEq3 = /* @__PURE__ */ notEq(eqStep);
  var lessThan3 = /* @__PURE__ */ lessThan(ordStep);
  var show32 = /* @__PURE__ */ show(showStep);
  var eq5 = /* @__PURE__ */ eq(eqStep);
  var fold3 = /* @__PURE__ */ fold2(monoidArray);
  var map7 = /* @__PURE__ */ map(functorArray);
  var matchKeyInfo2 = /* @__PURE__ */ matchKeyInfo()();
  var atInjectDiff2 = /* @__PURE__ */ atInjectDiff(showL);
  var show42 = /* @__PURE__ */ show(/* @__PURE__ */ showDiff(showL));
  var none2 = /* @__PURE__ */ none(unfoldableMaybe);
  var matchMapKeyInfo2 = /* @__PURE__ */ matchMapKeyInfo()();
  var movePointUntil2 = /* @__PURE__ */ movePointUntil(showL);
  var movePoint2 = /* @__PURE__ */ movePoint(showL);
  var logShow3 = /* @__PURE__ */ logShow2(monadEffectEffect)(showExpr2);
  var Inline_DisplayStyle = /* @__PURE__ */ function() {
    function Inline_DisplayStyle2() {
    }
    ;
    Inline_DisplayStyle2.value = new Inline_DisplayStyle2();
    return Inline_DisplayStyle2;
  }();
  var Nested_DisplayStyle = /* @__PURE__ */ function() {
    function Nested_DisplayStyle2() {
    }
    ;
    Nested_DisplayStyle2.value = new Nested_DisplayStyle2();
    return Nested_DisplayStyle2;
  }();
  var eqDisplayStyle = {
    eq: function(x) {
      return function(y) {
        if (x instanceof Inline_DisplayStyle && y instanceof Inline_DisplayStyle) {
          return true;
        }
        ;
        if (x instanceof Nested_DisplayStyle && y instanceof Nested_DisplayStyle) {
          return true;
        }
        ;
        return false;
      };
    }
  };
  var eq23 = /* @__PURE__ */ eq(eqDisplayStyle);
  var updateUiExpr = function(path) {
    return function(v) {
      return discard12(lift4(writeFlipped(unwrap3(v.l).meta.path)(path)))(function() {
        return discard12(lift4(traverse_2(function(uip) {
          return modifyFlipped(uip.point)(modify5(function(v1) {
            var $118 = {};
            for (var $119 in v1) {
              if ({}.hasOwnProperty.call(v1, $119)) {
                $118[$119] = v1[$119];
              }
              ;
            }
            ;
            $118.path = path;
            return $118;
          }));
        })(unwrap3(v.l).meta.uips)))(function() {
          return bind4(traverseWithIndex2(function(i_) {
            return function(kid) {
              return updateUiExpr(snoc2(path)(i_))(kid);
            };
          })(v.kids))(function(kids$prime) {
            return pure6({
              l: v.l,
              kids: kids$prime
            });
          });
        });
      });
    };
  };
  var newCtx = function __do() {
    var mb_root = $$new(Nothing.value)();
    var mb_handle = $$new(Nothing.value)();
    var mb_dragOrigin = $$new(Nothing.value)();
    return {
      mb_root,
      mb_handle,
      mb_dragOrigin
    };
  };
  var mkPureExpr = function(s) {
    return function(kids) {
      return mkExpr({
        dat: new $$String(s),
        meta: {}
      })(kids);
    };
  };
  var initialExpr_1 = /* @__PURE__ */ mkPureExpr("A")([/* @__PURE__ */ mkPureExpr("B")([]), /* @__PURE__ */ mkPureExpr("C")([])]);
  var getUiPoints_UiExpr = function(e) {
    return unwrap3(unwrap3(e).l).meta.uips;
  };
  var getRoot = /* @__PURE__ */ bind4(ask2)(function(ctx) {
    return bind4(lift4(read(ctx.mb_root)))(function(v) {
      if (v instanceof Nothing) {
        return lift4($$throw("getRoot: isNothing ctx.expr!"));
      }
      ;
      if (v instanceof Just) {
        return pure6(v.value0);
      }
      ;
      throw new Error("Failed pattern match at Ui.App (line 679, column 39 - line 681, column 27): " + [v.constructor.name]);
    });
  });
  var getUiPoint = function(v) {
    return bind4(getRoot)(function(root) {
      var expr = atSubExpr2(v.path)(root).here;
      return fromMaybeM2(lift4($$throw("getUiPoint: p.j out-of-bounds")))(index(unwrap3(unwrap3(expr).l).meta.uips)(unwrap3(v.j)));
    });
  };
  var modifyHandle = function(b) {
    return function(mb_handle) {
      var modifyClass = function() {
        if (b) {
          return addClass;
        }
        ;
        return removeClass;
      }();
      if (mb_handle instanceof Nothing) {
        return pure6(unit);
      }
      ;
      if (mb_handle instanceof Just && mb_handle.value0 instanceof Point_Handle) {
        return bind4(getUiPoint(mb_handle.value0.value0))(function(uip) {
          return discard12(lift4(modifyClass("Point_Handle")(uip.elem)))(function() {
            return lift4(modifyClass("HandleFocus")(uip.elem));
          });
        });
      }
      ;
      if (mb_handle instanceof Just && mb_handle.value0 instanceof SpanH_Handle) {
        var p = getEndPoints_SpanH(mb_handle.value0.value0);
        return bind4(getUiPoint(p["_L"]))(function(uip_L) {
          return discard12(lift4(modifyClass("SpanH_Handle_Left")(uip_L.elem)))(function() {
            return bind4(getUiPoint(p["_R"]))(function(uip_R) {
              return discard12(lift4(modifyClass("SpanH_Handle_Right")(uip_R.elem)))(function() {
                if (mb_handle.value0.value1 instanceof Left_SpanFocus) {
                  return lift4(modifyClass("HandleFocus")(uip_L.elem));
                }
                ;
                if (mb_handle.value0.value1 instanceof Right_SpanFocus) {
                  return lift4(modifyClass("HandleFocus")(uip_R.elem));
                }
                ;
                throw new Error("Failed pattern match at Ui.App (line 641, column 7 - line 643, column 73): " + [mb_handle.value0.value1.constructor.name]);
              });
            });
          });
        });
      }
      ;
      if (mb_handle instanceof Just && mb_handle.value0 instanceof ZipperH_Handle) {
        var p = getEndPoints_ZipperH(mb_handle.value0.value0);
        return bind4(getUiPoint(p["_OL"]))(function(uip_OL) {
          return discard12(lift4(modifyClass("ZipperH_Handle_OuterLeft")(uip_OL.elem)))(function() {
            return bind4(getUiPoint(p["_IL"]))(function(uip_IL) {
              return discard12(lift4(modifyClass("ZipperH_Handle_InnerLeft")(uip_IL.elem)))(function() {
                return bind4(getUiPoint(p["_IR"]))(function(uip_IR) {
                  return discard12(lift4(modifyClass("ZipperH_Handle_InnerRight")(uip_IR.elem)))(function() {
                    return bind4(getUiPoint(p["_OR"]))(function(uip_OR) {
                      return discard12(lift4(modifyClass("ZipperH_Handle_OuterRight")(uip_OR.elem)))(function() {
                        if (mb_handle.value0.value1 instanceof OuterLeft_ZipperFocus) {
                          return discard12(lift4(modifyClass("HandleFocus")(uip_OL.elem)))(function() {
                            return lift4(modifyClass("HandleFocusLeft")(uip_OL.elem));
                          });
                        }
                        ;
                        if (mb_handle.value0.value1 instanceof InnerLeft_ZipperFocus) {
                          return discard12(lift4(modifyClass("HandleFocus")(uip_IL.elem)))(function() {
                            return lift4(modifyClass("HandleFocusLeft")(uip_IL.elem));
                          });
                        }
                        ;
                        if (mb_handle.value0.value1 instanceof InnerRight_ZipperFocus) {
                          return discard12(lift4(modifyClass("HandleFocus")(uip_IR.elem)))(function() {
                            return lift4(modifyClass("HandleFocusRight")(uip_IR.elem));
                          });
                        }
                        ;
                        if (mb_handle.value0.value1 instanceof OuterRight_ZipperFocus) {
                          return discard12(lift4(modifyClass("HandleFocus")(uip_OR.elem)))(function() {
                            return lift4(modifyClass("HandleFocusRight")(uip_OR.elem));
                          });
                        }
                        ;
                        throw new Error("Failed pattern match at Ui.App (line 654, column 7 - line 666, column 62): " + [mb_handle.value0.value1.constructor.name]);
                      });
                    });
                  });
                });
              });
            });
          });
        });
      }
      ;
      throw new Error("Failed pattern match at Ui.App (line 629, column 3 - line 666, column 62): " + [mb_handle.constructor.name]);
    };
  };
  var setHandle = function(mb_handle$prime) {
    return bind4(ask2)(function(ctx) {
      return bind4(lift4(read(ctx.mb_handle)))(function(mb_handle) {
        return discard12(modifyHandle(false)(mb_handle))(function() {
          return discard12(modifyHandle(true)(mb_handle$prime))(function() {
            return lift4(writeFlipped(ctx.mb_handle)(mb_handle$prime));
          });
        });
      });
    });
  };
  var getElem_UiExpr = function(e) {
    return unwrap3(unwrap3(e).l).meta.elem;
  };
  var config = /* @__PURE__ */ function() {
    return {
      initialExpr: initialExpr_1,
      displayStyle: Inline_DisplayStyle.value
    };
  }();
  var cleanup_UiPoint = function(uip) {
    return traverse_2(function(eli) {
      return removeEventListener2(eli)(toEventTarget2(uip.elem));
    })(uip.eventListenerInfos);
  };
  var cleanup_uie_deep = function(v) {
    var elem_e = getElem_UiExpr(v);
    return function __do2() {
      traverse_2(function(eli) {
        return removeEventListener2(eli)(toEventTarget2(elem_e));
      })(unwrap3(v.l).meta.eventListenerInfos)();
      traverse_2(cleanup_UiPoint)(unwrap3(v.l).meta.uips)();
      return traverse_2(cleanup_uie_deep)(v.kids)();
    };
  };
  var cleanup_UiExpr_shallow = function(v) {
    var elem_e = getElem_UiExpr(v);
    return function __do2() {
      traverse_2(function(eli) {
        return removeEventListener2(eli)(toEventTarget2(elem_e));
      })(unwrap3(v.l).meta.eventListenerInfos)();
      return traverse_2(cleanup_UiPoint)(unwrap3(v.l).meta.uips)();
    };
  };
  var addEventListenerWithOptions3 = function() {
    return function() {
      return function(eventType) {
        return function(options) {
          return function(callback) {
            return function(target) {
              return bind4(ask2)(function(ctx) {
                return lift4(addEventListenerWithOptions1(eventType)(options)(function(event) {
                  return flip(runReaderT)(ctx)(callback(event));
                })(target));
              });
            };
          };
        };
      };
    };
  };
  var addEventListenerWithOptions22 = /* @__PURE__ */ addEventListenerWithOptions3()();
  var createUiPoint = function(v) {
    return bind4(ask2)(function(ctx) {
      return discard12(log3("createUiPoint " + show6(v)))(function() {
        return bind4(lift4($$new(v)))(function(pointRef) {
          return bind4(lift4(create("div")))(function(elem3) {
            return discard12(lift4(addClass("Point")(elem3)))(function() {
              return bind4(sequence12([addEventListenerWithOptions22("mousedown")({
                capture: true,
                passive: true
              })(function(event) {
                return bind4(lift4(read(pointRef)))(function(v1) {
                  return bind4(lift4(read(ctx.mb_handle)))(function(v2) {
                    if (v2 instanceof Just && shiftKey(event)) {
                      return bind4(getRoot)(function(expr) {
                        return discard12(lift4(writeFlipped(ctx.mb_dragOrigin)(pure22(v2.value0))))(function() {
                          var v3 = drag2(v2.value0)(v1)(expr);
                          if (v3 instanceof Nothing) {
                            return pure6(unit);
                          }
                          ;
                          if (v3 instanceof Just) {
                            return setHandle(pure22(v3.value0));
                          }
                          ;
                          throw new Error("Failed pattern match at Ui.App (line 406, column 13 - line 408, column 45): " + [v3.constructor.name]);
                        });
                      });
                    }
                    ;
                    if (v2 instanceof Just) {
                      return bind4(getRoot)(function(root) {
                        var dragOrigin = getDragOrigin(v2.value0)(v1);
                        return discard12(lift4(writeFlipped(ctx.mb_dragOrigin)(pure22(dragOrigin))))(function() {
                          var v3 = drag2(dragOrigin)(v1)(root);
                          if (v3 instanceof Nothing) {
                            return pure6(unit);
                          }
                          ;
                          if (v3 instanceof Just) {
                            return setHandle(pure22(v3.value0));
                          }
                          ;
                          throw new Error("Failed pattern match at Ui.App (line 413, column 13 - line 415, column 45): " + [v3.constructor.name]);
                        });
                      });
                    }
                    ;
                    var h$prime = new Point_Handle(v1);
                    return discard12(lift4(writeFlipped(ctx.mb_dragOrigin)(pure22(h$prime))))(function() {
                      return setHandle(pure22(h$prime));
                    });
                  });
                });
              })(toEventTarget2(elem3)), addEventListenerWithOptions22("mouseenter")({
                capture: true,
                passive: true
              })(function(_event) {
                return bind4(lift4(read(pointRef)))(function(v1) {
                  return bind4(lift4(read(ctx.mb_dragOrigin)))(function(mb_dragOrigin) {
                    if (mb_dragOrigin instanceof Nothing) {
                      return pure6(unit);
                    }
                    ;
                    if (mb_dragOrigin instanceof Just) {
                      return bind4(getRoot)(function(root) {
                        var v2 = drag2(mb_dragOrigin.value0)(v1)(root);
                        if (v2 instanceof Nothing) {
                          return pure6(unit);
                        }
                        ;
                        if (v2 instanceof Just) {
                          return setHandle(pure22(v2.value0));
                        }
                        ;
                        throw new Error("Failed pattern match at Ui.App (line 428, column 13 - line 430, column 45): " + [v2.constructor.name]);
                      });
                    }
                    ;
                    throw new Error("Failed pattern match at Ui.App (line 424, column 9 - line 430, column 45): " + [mb_dragOrigin.constructor.name]);
                  });
                });
              })(toEventTarget2(elem3))]))(function(eventListenerInfos) {
                return discard12(lift4(function __do2() {
                  var elem_Focus = createChild("div")(elem3)();
                  addClass("Focus")(elem_Focus)();
                  var elem_L = createChild("div")(elem3)();
                  addClass("Left")(elem_L)();
                  var elem_M = createChild("div")(elem3)();
                  addClass("Middle")(elem_M)();
                  var elem_R = createChild("div")(elem3)();
                  return addClass("Right")(elem_R)();
                }))(function() {
                  return pure6({
                    elem: elem3,
                    eventListenerInfos,
                    point: pointRef
                  });
                });
              });
            });
          });
        });
      });
    });
  };
  var assembleUiExpr = function(path_ref) {
    return function(elem_expr) {
      return function(label) {
        return function(kids) {
          return bind4(lift4(read(path_ref)))(function(path) {
            return discard12(lift4(addClass("Expr")(elem_expr)))(function() {
              return discard12(function() {
                if (config.displayStyle instanceof Inline_DisplayStyle) {
                  return lift4(addClass("Inline")(elem_expr));
                }
                ;
                if (config.displayStyle instanceof Nested_DisplayStyle) {
                  return lift4(addClass("Nested")(elem_expr));
                }
                ;
                throw new Error("Failed pattern match at Ui.App (line 325, column 3 - line 327, column 72): " + [config.displayStyle.constructor.name]);
              }())(function() {
                return discard12(function() {
                  if (label.dat instanceof Root) {
                    return lift4(addClass("Root")(elem_expr));
                  }
                  ;
                  return pure6(unit);
                }())(function() {
                  return bind4(lift4(sequence22([])))(function(eventListenerInfos) {
                    return discard12(when2(eq23(config.displayStyle)(Inline_DisplayStyle.value))(bind4(lift4(createChild("div")(elem_expr)))(function(elem_open) {
                      return discard12(lift4(addClass("Punctuation")(elem_open)))(function() {
                        return lift4(setTextContent(function() {
                          if (label.dat instanceof Root) {
                            return "";
                          }
                          ;
                          return "(";
                        }())(toNode(elem_open)));
                      });
                    })))(function() {
                      return discard12(bind4(lift4(createChild("div")(elem_expr)))(function(elem_label) {
                        return discard12(lift4(addClass("Label")(elem_label)))(function() {
                          return lift4(setTextContent(show1(label))(toNode(elem_label)));
                        });
                      }))(function() {
                        return bind4(traverseWithIndex2(function(i_) {
                          return function(uie_kid) {
                            var j = getIndexesAroundStep(i_)["_L"];
                            return bind4(createUiPoint({
                              path,
                              j
                            }))(function(uip) {
                              return discard12(lift4(appendChild2(uip.elem)(elem_expr)))(function() {
                                return discard12(lift4(appendChild2(getElem_UiExpr(uie_kid))(elem_expr)))(function() {
                                  return pure6(uip);
                                });
                              });
                            });
                          };
                        })(kids))(function(uips_init) {
                          return bind4(createUiPoint({
                            path,
                            j: offset_Span(kids)
                          }))(function(uip_last) {
                            return discard12(lift4(appendChild2(uip_last.elem)(elem_expr)))(function() {
                              var uips = snoc(uips_init)(uip_last);
                              return discard12(when2(eq23(config.displayStyle)(Inline_DisplayStyle.value))(bind4(lift4(createChild("div")(elem_expr)))(function(elem_close) {
                                return discard12(lift4(addClass("Punctuation")(elem_close)))(function() {
                                  return lift4(setTextContent(function() {
                                    if (label.dat instanceof Root) {
                                      return "";
                                    }
                                    ;
                                    return ")";
                                  }())(toNode(elem_close)));
                                });
                              })))(function() {
                                return pure6({
                                  l: over2(L2)(function(v) {
                                    return {
                                      dat: v.dat,
                                      meta: {
                                        elem: elem_expr,
                                        eventListenerInfos,
                                        path: path_ref,
                                        uips
                                      }
                                    };
                                  })(label),
                                  kids
                                });
                              });
                            });
                          });
                        });
                      });
                    });
                  });
                });
              });
            });
          });
        };
      };
    };
  };
  var createUiExpr$prime = function(path0) {
    return function(label) {
      return function(steps) {
        return function(renderKid) {
          return bind4(lift4($$new(path0)))(function(path_ref) {
            return bind4(lift4(create("div")))(function(elem_expr) {
              return bind4(traverse2(renderKid)(steps))(function(uies_kids) {
                return assembleUiExpr(path_ref)(elem_expr)(label)(uies_kids);
              });
            });
          });
        };
      };
    };
  };
  var createUiExpr = function(path) {
    return function(v) {
      return discard12(log3("createUiExpr: " + show23(v)))(function() {
        return createUiExpr$prime(path)(v.l)(rangeKidSteps(v))(function(i) {
          return bind4(fromMaybeM2(lift4($$throw("kid index out of bounds")))(getKid_Expr2(i)(v)))(function(kid) {
            return createUiExpr(snoc2(path)(i))(kid);
          });
        });
      });
    };
  };
  var updateUiExprViaDiff = function(v) {
    return function(v1) {
      return function(v2) {
        return function(v3) {
          return function(v4) {
            if (v4 instanceof Id_Diff) {
              var $170 = !v;
              if ($170) {
                return pure6(v3);
              }
              ;
              return updateUiExpr(v1)(v3);
            }
            ;
            if (v4 instanceof Inject_Diff) {
              return discard12(lift4(writeFlipped(unwrap3(v3.l).meta.path)(v1)))(function() {
                return discard12(lift4(traverse_2(function(uip) {
                  return modifyFlipped(uip.point)(modify5(function(v5) {
                    var $171 = {};
                    for (var $172 in v5) {
                      if ({}.hasOwnProperty.call(v5, $172)) {
                        $171[$172] = v5[$172];
                      }
                      ;
                    }
                    ;
                    $171.path = v1;
                    return $171;
                  }));
                })(unwrap3(v3.l).meta.uips)))(function() {
                  return bind4(traverseWithIndex2(function(i_) {
                    return function(d) {
                      return bind4(fromMaybeM2(lift4($$throw("kid index out of bounds")))(getKid_Expr2(i_)(v3)))(function(kid) {
                        return updateUiExprViaDiff(false)(snoc2(v1)(i_))(new Just(getElem_UiExpr(v3)))(kid)(d);
                      });
                    };
                  })(v4.value0))(function(kids$prime) {
                    return pure6({
                      l: v3.l,
                      kids: kids$prime
                    });
                  });
                });
              });
            }
            ;
            if (v4 instanceof DeleteTooth_Diff) {
              return bind4(fromMaybeM2(lift4($$throw("can't DeleteTooth_Diff at Root")))(v2))(function(parent) {
                return discard12(traverseWithIndex_2(function(i$prime_) {
                  return function(e_kid) {
                    return when2(notEq3(v4.value0)(i$prime_))(discard12(lift4(cleanup_uie_deep(e_kid)))(function() {
                      return lift4(removeChild2(getElem_UiExpr(e_kid))(getElem_UiExpr(v3)));
                    }));
                  };
                })(v3.kids))(function() {
                  return bind4(fromMaybeM2(lift4($$throw("kid index out of bounds")))(getKid_Expr2(v4.value0)(v3)))(function(e_kid) {
                    return discard12(lift4(cleanup_UiExpr_shallow(v3)))(function() {
                      return discard12(lift4(replaceChild2(getElem_UiExpr(v3))(getElem_UiExpr(e_kid))(parent)))(function() {
                        return updateUiExprViaDiff(true)(v1)(new Just(parent))(e_kid)(v4.value1);
                      });
                    });
                  });
                });
              });
            }
            ;
            if (v4 instanceof InsertTooth_Diff) {
              return bind4(fromMaybeM2(lift4($$throw("can't InsertTooth_Diff at Root")))(v2))(function(parent) {
                return bind4(lift4(create("div")))(function(e$prime_placeholder) {
                  return discard12(lift4(setText("{{e'_placeholder}}")(e$prime_placeholder)))(function() {
                    return discard12(lift4(replaceChild2(getElem_UiExpr(v3))(e$prime_placeholder)(parent)))(function() {
                      var kids_L_length = length(v4.value0.kids_L);
                      var kids_R_length = length(v4.value0.kids_R);
                      return bind4(createUiExpr$prime(v1)(v4.value0.l)(rangeSteps({
                        "_L": 0,
                        "_R": kids_L_length + kids_R_length | 0
                      }))(function(i) {
                        var $177 = lessThan3(i)(kids_L_length);
                        if ($177) {
                          return bind4(fromMaybeM2(lift4($$throw("updateUiExprViaDiff InsertTooth_Diff: step out-of-bounds: " + show32(i))))(index(v4.value0.kids_L)(unwrap3(i))))(function(kid) {
                            return bind4(createUiExpr(snoc2(v1)(i))(kid))(function(uie_kid) {
                              return pure6(uie_kid);
                            });
                          });
                        }
                        ;
                        var $178 = eq5(i)(kids_L_length);
                        if ($178) {
                          return bind4(lift4(create("div")))(function(e_parent_placeholder) {
                            return discard12(lift4(setText("{{e_parent_placeholder}}")(e_parent_placeholder)))(function() {
                              return updateUiExprViaDiff(true)(snoc2(v1)(i))(new Just(e_parent_placeholder))(v3)(v4.value1);
                            });
                          });
                        }
                        ;
                        return bind4(fromMaybeM2(lift4($$throw("updateUiExprViaDiff InsertTooth_Diff: step out-of-bounds: " + show32(i))))(index(v4.value0.kids_R)(((-kids_L_length | 0) + (-1 | 0) | 0) + unwrap3(i) | 0)))(function(kid) {
                          return bind4(createUiExpr(snoc2(v1)(i))(kid))(function(uie_kid) {
                            return pure6(uie_kid);
                          });
                        });
                      }))(function(e$prime) {
                        return discard12(lift4(replaceChild2(e$prime_placeholder)(getElem_UiExpr(e$prime))(parent)))(function() {
                          return pure6(e$prime);
                        });
                      });
                    });
                  });
                });
              });
            }
            ;
            if (v4 instanceof ReplaceSpan_Diff) {
              var e_elem = getElem_UiExpr(v3);
              var e_uips = getUiPoints_UiExpr(v3);
              var at_diff = atIndexSpan_Expr(v4.value0)(v4.value1)(v3);
              var pre_kids = fold3([map7(First2.create)(unwrap3(at_diff.outside).kids_L), map7(Second.create)(unwrap3(v4.value2)), map7(Third.create)(unwrap3(at_diff.outside).kids_R)]);
              return discard12(lift4(removeAllChildren(e_elem)))(function() {
                return todo2("updateUiExprViaDiff ... (ReplaceSpan_Diff j0 j1 span) ...");
              });
            }
            ;
            if (v4 instanceof Replace_Diff) {
              return bind4(fromMaybeM2(lift4($$throw("can't DeleteTooth_Diff at Root")))(v2))(function(parent) {
                return discard12(lift4(cleanup_uie_deep(v3)))(function() {
                  return bind4(createUiExpr(v1)(v4.value0))(function(e$prime) {
                    return discard12(lift4(replaceChild2(getElem_UiExpr(v3))(getElem_UiExpr(e$prime))(parent)))(function() {
                      return pure6(e$prime);
                    });
                  });
                });
              });
            }
            ;
            throw new Error("Failed pattern match at Ui.App (line 477, column 1 - line 477, column 102): " + [v.constructor.name, v1.constructor.name, v2.constructor.name, v3.constructor.name, v4.constructor.name]);
          };
        };
      };
    };
  };
  var updateUiExprViaDiff_root = function(diff0) {
    return bind4(ask2)(function(ctx) {
      return bind4(getRoot)(function(root) {
        return bind4(updateUiExprViaDiff(false)(Nil.value)(new Just(getElem_UiExpr(root)))(root)(diff0))(function(root$prime) {
          return lift4(writeFlipped(ctx.mb_root)(pure22(root$prime)));
        });
      });
    });
  };
  var eventListenerInfo_keydown_Editor = /* @__PURE__ */ addEventListenerWithOptions22("keydown")({
    capture: true
  })(function(event) {
    return bind4(ask2)(function(ctx) {
      var v = fromEventToKeyInfo(event);
      return bind4(lift4(read(ctx.mb_dragOrigin)))(function(mb_dragOrigin) {
        return bind4(lift4(read(ctx.mb_handle)))(function(mb_handle) {
          var v1 = function(v2) {
            var v3 = function(v4) {
              var v5 = function(v6) {
                if (matchKeyInfo2(isAlpha)({
                  cmd: pure22(false),
                  alt: pure22(false)
                })(v)) {
                  if (mb_handle instanceof Nothing) {
                    return pure6(unit);
                  }
                  ;
                  if (mb_handle instanceof Just) {
                    return bind4(getRoot)(function(expr) {
                      return discard12(function() {
                        if (mb_handle.value0 instanceof Point_Handle) {
                          var v7 = toNePath(mb_handle.value0.value0.path);
                          if (v7 instanceof Nothing) {
                            return pure6(unit);
                          }
                          ;
                          if (v7 instanceof Just) {
                            var t = {
                              l: mkL(new $$String(v.key))({}),
                              kids_L: [],
                              kids_R: []
                            };
                            var diff = atInjectDiff2(v7.value0)(function(_expr$prime) {
                              return new InsertTooth_Diff(t, Id_Diff.value);
                            })(expr);
                            return discard12(log3("diff = " + show42(diff)))(function() {
                              return discard12(setHandle(none2))(function() {
                                return updateUiExprViaDiff_root(diff);
                              });
                            });
                          }
                          ;
                          throw new Error("Failed pattern match at Ui.App (line 222, column 15 - line 231, column 48): " + [v7.constructor.name]);
                        }
                        ;
                        return pure6(unit);
                      }())(function() {
                        return pure6(unit);
                      });
                    });
                  }
                  ;
                  throw new Error("Failed pattern match at Ui.App (line 216, column 7 - line 233, column 20): " + [mb_handle.constructor.name]);
                }
                ;
                if (matchKeyInfo2(function(v7) {
                  return v7 === "1";
                })({
                  cmd: pure22(true)
                })(v)) {
                  return discard12(lift4(preventDefault(event)))(function() {
                    return discard12(lift4(writeFlipped(ctx.mb_dragOrigin)(none2)))(function() {
                      return discard12(setHandle(Nothing.value))(function() {
                        return updateUiExprViaDiff_root(new Inject_Diff([new DeleteTooth_Diff(0, new Inject_Diff([]))]));
                      });
                    });
                  });
                }
                ;
                if (matchKeyInfo2(function(v7) {
                  return v7 === "2";
                })({
                  cmd: pure22(true)
                })(v)) {
                  return discard12(lift4(preventDefault(event)))(function() {
                    return discard12(lift4(writeFlipped(ctx.mb_dragOrigin)(none2)))(function() {
                      return discard12(setHandle(Nothing.value))(function() {
                        return updateUiExprViaDiff_root(new Inject_Diff([new Replace_Diff(mkPureExpr("D")([]))]));
                      });
                    });
                  });
                }
                ;
                if (matchKeyInfo2(function(v7) {
                  return v7 === "3";
                })({
                  cmd: pure22(true)
                })(v)) {
                  return discard12(lift4(preventDefault(event)))(function() {
                    return discard12(lift4(writeFlipped(ctx.mb_dragOrigin)(none2)))(function() {
                      return discard12(setHandle(Nothing.value))(function() {
                        return updateUiExprViaDiff_root(new Inject_Diff([new InsertTooth_Diff({
                          l: {
                            dat: new $$String("D"),
                            meta: {}
                          },
                          kids_L: [mkPureExpr("E")([])],
                          kids_R: [mkPureExpr("F")([])]
                        }, new Inject_Diff([new Inject_Diff([]), new Inject_Diff([])]))]));
                      });
                    });
                  });
                }
                ;
                return pure6(unit);
              };
              var $194 = matchMapKeyInfo2(fromKeyToDir)({
                cmd: new Just(false),
                shift: new Just(false),
                alt: new Just(true)
              })(v);
              if ($194 instanceof Just) {
                if (mb_handle instanceof Nothing) {
                  return pure6(unit);
                }
                ;
                if (mb_handle instanceof Just) {
                  return setHandle(new Just(moveHandleFocus($194.value0)(mb_handle.value0)));
                }
                ;
                throw new Error("Failed pattern match at Ui.App (line 210, column 7 - line 213, column 68): " + [mb_handle.constructor.name]);
              }
              ;
              return v5(true);
            };
            var $199 = matchMapKeyInfo2(fromKeyToDir)({
              cmd: new Just(false),
              shift: new Just(true),
              alt: new Just(false)
            })(v);
            if ($199 instanceof Just) {
              return discard12(log3("drag move"))(function() {
                return discard12(lift4(preventDefault(event)))(function() {
                  if (mb_handle instanceof Nothing) {
                    return discard12(function() {
                      if (mb_dragOrigin instanceof Nothing) {
                        return lift4(writeFlipped(ctx.mb_dragOrigin)(pure22(defaultHandle)));
                      }
                      ;
                      if (mb_dragOrigin instanceof Just) {
                        return pure6(unit);
                      }
                      ;
                      throw new Error("Failed pattern match at Ui.App (line 188, column 11 - line 192, column 24): " + [mb_dragOrigin.constructor.name]);
                    }())(function() {
                      return setHandle(new Just(defaultHandle));
                    });
                  }
                  ;
                  if (mb_handle instanceof Just) {
                    return bind4(getRoot)(function(root) {
                      return bind4(function() {
                        if (mb_dragOrigin instanceof Nothing) {
                          return discard12(log3("initialize dragOrigin"))(function() {
                            return discard12(lift4(writeFlipped(ctx.mb_dragOrigin)(pure22(mb_handle.value0))))(function() {
                              return pure6(mb_handle.value0);
                            });
                          });
                        }
                        ;
                        if (mb_dragOrigin instanceof Just) {
                          return pure6(mb_dragOrigin.value0);
                        }
                        ;
                        throw new Error("Failed pattern match at Ui.App (line 197, column 25 - line 203, column 30): " + [mb_dragOrigin.constructor.name]);
                      }())(function(dragOrigin) {
                        var v4 = movePointUntil2(root)($199.value0)(getFocusPoint(mb_handle.value0))(function(p) {
                          return drag2(dragOrigin)(p)(root);
                        });
                        if (v4 instanceof Nothing) {
                          return pure6(unit);
                        }
                        ;
                        if (v4 instanceof Just) {
                          return setHandle(new Just(v4.value0));
                        }
                        ;
                        throw new Error("Failed pattern match at Ui.App (line 204, column 11 - line 207, column 39): " + [v4.constructor.name]);
                      });
                    });
                  }
                  ;
                  throw new Error("Failed pattern match at Ui.App (line 185, column 7 - line 207, column 39): " + [mb_handle.constructor.name]);
                });
              });
            }
            ;
            return v3(true);
          };
          var $210 = matchMapKeyInfo2(fromKeyToDir)({
            cmd: new Just(false),
            shift: new Just(false),
            alt: new Just(false)
          })(v);
          if ($210 instanceof Just) {
            return discard12(lift4(preventDefault(event)))(function() {
              return discard12(lift4(writeFlipped(ctx.mb_dragOrigin)(none2)))(function() {
                if (mb_handle instanceof Nothing) {
                  return setHandle(new Just(defaultHandle));
                }
                ;
                if (mb_handle instanceof Just) {
                  return bind4(getRoot)(function(root) {
                    var v2 = movePoint2(root)($210.value0)(getFocusPoint(mb_handle.value0));
                    if (v2 instanceof Nothing) {
                      return setHandle(new Just(new Point_Handle(getFocusPoint(mb_handle.value0))));
                    }
                    ;
                    if (v2 instanceof Just) {
                      return setHandle(new Just(new Point_Handle(v2.value0)));
                    }
                    ;
                    throw new Error("Failed pattern match at Ui.App (line 178, column 11 - line 180, column 64): " + [v2.constructor.name]);
                  });
                }
                ;
                throw new Error("Failed pattern match at Ui.App (line 173, column 7 - line 180, column 64): " + [mb_handle.constructor.name]);
              });
            });
          }
          ;
          return v1(true);
        });
      });
    });
  })(/* @__PURE__ */ toEventTarget(doc));
  var eventListenerInfo_stopDrag_Editor = /* @__PURE__ */ addEventListenerWithOptions22("mouseup")({
    capture: true,
    passive: true
  })(function(_event) {
    return bind4(ask2)(function(ctx) {
      return lift4(writeFlipped(ctx.mb_dragOrigin)(none2));
    });
  })(/* @__PURE__ */ toEventTarget(doc));
  var createEditor = function(parent) {
    var expr_ = mkExpr(mkL(Root.value)({}))([config.initialExpr]);
    return function __do2() {
      logShow3(expr_)();
      var ctx = newCtx();
      var elem3 = createChild("div")(parent)();
      addClass("Editor")(elem3)();
      var expr = flip(runReaderT)(ctx)(createUiExpr(Nil.value)(expr_))();
      appendChild2(getElem_UiExpr(expr))(elem3)();
      writeFlipped(ctx.mb_root)(pure22(expr))();
      var eventListenerInfos = flip(runReaderT)(ctx)(sequence12([eventListenerInfo_stopDrag_Editor, eventListenerInfo_keydown_Editor]))();
      return {
        elem: elem3,
        eventListenerInfos
      };
    };
  };
  var main = /* @__PURE__ */ $$void(functorEffect)(/* @__PURE__ */ createEditor(body));

  // output/Ui/index.js
  var main2 = /* @__PURE__ */ function() {
    if (true) {
      return main;
    }
    ;
    return liftEffect(monadEffectEffect)($$throw("unrecognized main label: " + show(showString)("App")));
  }();

  // <stdin>
  main2();
})();
